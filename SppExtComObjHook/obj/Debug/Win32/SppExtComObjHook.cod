; Listing generated by Microsoft (R) Optimizing Compiler Version 19.23.28105.4 

	TITLE	C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?LoadLibraryW_Hook@@YGPAUHINSTANCE__@@PB_W@Z	; LoadLibraryW_Hook
PUBLIC	?RpcStringBindingComposeW_Hook@@YGJPA_W0000PAPA_W@Z ; RpcStringBindingComposeW_Hook
PUBLIC	?RpcBindingFromStringBindingW_Hook@@YGJPA_WPAPAX@Z ; RpcBindingFromStringBindingW_Hook
PUBLIC	?RpcStringFreeW_Hook@@YGJPAPA_W@Z		; RpcStringFreeW_Hook
PUBLIC	?RpcBindingFree_Hook@@YGJPAPAX@Z		; RpcBindingFree_Hook
PUBLIC	?RpcAsyncInitializeHandle_Hook@@YGJPAU_RPC_ASYNC_STATE@@I@Z ; RpcAsyncInitializeHandle_Hook
PUBLIC	?RpcAsyncCompleteCall_Hook@@YGJPAU_RPC_ASYNC_STATE@@PAX@Z ; RpcAsyncCompleteCall_Hook
PUBLIC	?NdrAsyncClientCall_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ ; NdrAsyncClientCall_Hook
PUBLIC	?NdrClientCall2_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ ; NdrClientCall2_Hook
PUBLIC	?APIHooks@@3PAU_APIHook@@A			; APIHooks
PUBLIC	??_C@_0N@MDJJJHMB@kernel32?4dll@		; `string'
PUBLIC	??_C@_0N@KCFDJLIF@LoadLibraryW@			; `string'
PUBLIC	??_C@_0L@IKBIFNGI@rpcrt4?4dll@			; `string'
PUBLIC	??_C@_0BJ@IIAFMCPB@RpcStringBindingComposeW@	; `string'
PUBLIC	??_C@_0BN@HIKGGOEI@RpcBindingFromStringBindingW@ ; `string'
PUBLIC	??_C@_0P@DGHKDIOM@RpcStringFreeW@		; `string'
PUBLIC	??_C@_0P@CPMKCJMK@RpcBindingFree@		; `string'
PUBLIC	??_C@_0BJ@NFGKIHEA@RpcAsyncInitializeHandle@	; `string'
PUBLIC	??_C@_0BF@JMLJHIHJ@RpcAsyncCompleteCall@	; `string'
PUBLIC	??_C@_0BD@GLHCKACO@NdrAsyncClientCall@		; `string'
PUBLIC	??_C@_0P@ELNNJCED@NdrClientCall2@		; `string'
PUBLIC	?newRpcConnection@@3U_RpcConnection@@A		; newRpcConnection
_BSS	SEGMENT
?newRpcConnection@@3U_RpcConnection@@A DB 0114H DUP (?)	; newRpcConnection
_BSS	ENDS
msvcjmc	SEGMENT
__7242C389_ctype@h DB 01H
__90A1F774_basetsd@h DB 01H
__367CC694_corecrt_memcpy_s@h DB 01H
__35D7DDB3_corecrt_memory@h DB 01H
__DC9673E3_corecrt_wstring@h DB 01H
__A29A7DFB_string@h DB 01H
__3C23D660_guiddef@h DB 01H
__AF541008_winnt@h DB 01H
__76CD430D_winerror@h DB 01H
__737D49DB_winbase@h DB 01H
__1B9502AC_winuser@h DB 01H
__376EBCA0_winioctl@h DB 01H
__24E9E95F_stdlib@h DB 01H
__2CCBBE23_propidl@h DB 01H
__AD360DAF_oleauto@h DB 01H
__0396F1A5_stralign@h DB 01H
__8C200215_imagehlp@h DB 01H
__F66CEB67_corecrt_stdio_config@h DB 01H
__101834BA_corecrt_wstdio@h DB 01H
__4CDD1C48_SppExtComObjHook@cpp DB 01H
msvcjmc	ENDS
;	COMDAT ??_C@_0P@ELNNJCED@NdrClientCall2@
CONST	SEGMENT
??_C@_0P@ELNNJCED@NdrClientCall2@ DB 'NdrClientCall2', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BD@GLHCKACO@NdrAsyncClientCall@
CONST	SEGMENT
??_C@_0BD@GLHCKACO@NdrAsyncClientCall@ DB 'NdrAsyncClientCall', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BF@JMLJHIHJ@RpcAsyncCompleteCall@
CONST	SEGMENT
??_C@_0BF@JMLJHIHJ@RpcAsyncCompleteCall@ DB 'RpcAsyncCompleteCall', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BJ@NFGKIHEA@RpcAsyncInitializeHandle@
CONST	SEGMENT
??_C@_0BJ@NFGKIHEA@RpcAsyncInitializeHandle@ DB 'RpcAsyncInitializeHandle'
	DB	00H						; `string'
CONST	ENDS
;	COMDAT ??_C@_0P@CPMKCJMK@RpcBindingFree@
CONST	SEGMENT
??_C@_0P@CPMKCJMK@RpcBindingFree@ DB 'RpcBindingFree', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0P@DGHKDIOM@RpcStringFreeW@
CONST	SEGMENT
??_C@_0P@DGHKDIOM@RpcStringFreeW@ DB 'RpcStringFreeW', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BN@HIKGGOEI@RpcBindingFromStringBindingW@
CONST	SEGMENT
??_C@_0BN@HIKGGOEI@RpcBindingFromStringBindingW@ DB 'RpcBindingFromString'
	DB	'BindingW', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0BJ@IIAFMCPB@RpcStringBindingComposeW@
CONST	SEGMENT
??_C@_0BJ@IIAFMCPB@RpcStringBindingComposeW@ DB 'RpcStringBindingComposeW'
	DB	00H						; `string'
CONST	ENDS
;	COMDAT ??_C@_0L@IKBIFNGI@rpcrt4?4dll@
CONST	SEGMENT
??_C@_0L@IKBIFNGI@rpcrt4?4dll@ DB 'rpcrt4.dll', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@KCFDJLIF@LoadLibraryW@
CONST	SEGMENT
??_C@_0N@KCFDJLIF@LoadLibraryW@ DB 'LoadLibraryW', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@MDJJJHMB@kernel32?4dll@
CONST	SEGMENT
??_C@_0N@MDJJJHMB@kernel32?4dll@ DB 'kernel32.dll', 00H	; `string'
CONST	ENDS
_DATA	SEGMENT
?APIHooks@@3PAU_APIHook@@A DD FLAT:??_C@_0N@MDJJJHMB@kernel32?4dll@ ; APIHooks
	DD	FLAT:??_C@_0N@KCFDJLIF@LoadLibraryW@
	DD	FLAT:?LoadLibraryW_Hook@@YGPAUHINSTANCE__@@PB_W@Z
	DD	00H
	DD	FLAT:??_C@_0L@IKBIFNGI@rpcrt4?4dll@
	DD	FLAT:??_C@_0BJ@IIAFMCPB@RpcStringBindingComposeW@
	DD	FLAT:?RpcStringBindingComposeW_Hook@@YGJPA_W0000PAPA_W@Z
	DD	00H
	DD	FLAT:??_C@_0L@IKBIFNGI@rpcrt4?4dll@
	DD	FLAT:??_C@_0BN@HIKGGOEI@RpcBindingFromStringBindingW@
	DD	FLAT:?RpcBindingFromStringBindingW_Hook@@YGJPA_WPAPAX@Z
	DD	00H
	DD	FLAT:??_C@_0L@IKBIFNGI@rpcrt4?4dll@
	DD	FLAT:??_C@_0P@DGHKDIOM@RpcStringFreeW@
	DD	FLAT:?RpcStringFreeW_Hook@@YGJPAPA_W@Z
	DD	00H
	DD	FLAT:??_C@_0L@IKBIFNGI@rpcrt4?4dll@
	DD	FLAT:??_C@_0P@CPMKCJMK@RpcBindingFree@
	DD	FLAT:?RpcBindingFree_Hook@@YGJPAPAX@Z
	DD	00H
	DD	FLAT:??_C@_0L@IKBIFNGI@rpcrt4?4dll@
	DD	FLAT:??_C@_0BJ@NFGKIHEA@RpcAsyncInitializeHandle@
	DD	FLAT:?RpcAsyncInitializeHandle_Hook@@YGJPAU_RPC_ASYNC_STATE@@I@Z
	DD	00H
	DD	FLAT:??_C@_0L@IKBIFNGI@rpcrt4?4dll@
	DD	FLAT:??_C@_0BF@JMLJHIHJ@RpcAsyncCompleteCall@
	DD	FLAT:?RpcAsyncCompleteCall_Hook@@YGJPAU_RPC_ASYNC_STATE@@PAX@Z
	DD	00H
	DD	FLAT:??_C@_0L@IKBIFNGI@rpcrt4?4dll@
	DD	FLAT:??_C@_0BD@GLHCKACO@NdrAsyncClientCall@
	DD	FLAT:?NdrAsyncClientCall_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ
	DD	00H
	DD	FLAT:??_C@_0L@IKBIFNGI@rpcrt4?4dll@
	DD	FLAT:??_C@_0P@ELNNJCED@NdrClientCall2@
	DD	FLAT:?NdrClientCall2_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ
	DD	00H
_DATA	ENDS
PUBLIC	?PatchIAT@@YGHPAUHINSTANCE__@@@Z		; PatchIAT
PUBLIC	?GetImportDescriptor@@YGPAU_IMAGE_IMPORT_DESCRIPTOR@@PAUHINSTANCE__@@@Z ; GetImportDescriptor
PUBLIC	?PatchIATInternal@@YGHPAUHINSTANCE__@@PAU_APIHook@@@Z ; PatchIATInternal
PUBLIC	_DllMain@12
PUBLIC	__JustMyCode_Default
PUBLIC	??_C@_1IM@KEMAINMH@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1BK@MGFBEOIA@?$AAO?$AAS?$AAP?$AAP?$AAO?$AAB?$AAJ?$AAS?$AA?4?$AAD?$AAL?$AAL@ ; `string'
PUBLIC	??_C@_1BI@IDEMALCL@?$AAS?$AAP?$AAP?$AAO?$AAB?$AAJ?$AAS?$AA?4?$AAD?$AAL?$AAL@ ; `string'
PUBLIC	??_C@_1HK@KJBODIAK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1ME@JMHPJKGI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1BK@BPGFLIHL@?$AAn?$AAc?$AAa?$AAc?$AAn?$AA_?$AAi?$AAp?$AA_?$AAt?$AAc?$AAp@ ; `string'
PUBLIC	??_C@_1HO@DNFNIJBK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1BE@LJLJKOKP@?$AA?$CF?$AAs?$AA?3?$AA?$CF?$AAs?$AA?$FL?$AA?$CF?$AAs?$AA?$FN@ ; `string'
PUBLIC	??_C@_1BE@KGBJBGOH@?$AA1?$AA2?$AA7?$AA?4?$AA0?$AA?4?$AA0?$AA?4?$AA1@ ; `string'
PUBLIC	??_C@_1GO@DBPOPFCA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1HO@OCCPDHFI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1MG@BBLFGBJD@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1FE@FENPFILD@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1EO@KEMOBAPK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1HG@CMDJOPCN@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1HG@EPAGGJO@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1FM@FFJCOKGI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1BFE@HBFGDEEA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1HE@KAFLNIFK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1HI@HFEFOPKC@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1HG@MBEKBOEL@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1FE@FPIONGCM@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1BDG@BEEGGHPN@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1KM@MANCCKDA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
PUBLIC	??_C@_1GC@IBFPKKP@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ ; `string'
EXTRN	_memset:PROC
EXTRN	_wcsstr:PROC
EXTRN	__imp__wcscpy_s:PROC
EXTRN	__imp___wcsicmp:PROC
EXTRN	__imp___wcsupr_s:PROC
EXTRN	__imp___stricmp:PROC
EXTRN	__imp__OutputDebugStringW@4:PROC
EXTRN	__imp__GetLastError@0:PROC
EXTRN	__imp__SetLastError@4:PROC
EXTRN	__imp__SetEvent@4:PROC
EXTRN	__imp__GetCurrentProcess@0:PROC
EXTRN	__imp__GetCurrentThread@0:PROC
EXTRN	__imp__VirtualProtect@16:PROC
EXTRN	__imp__WriteProcessMemory@20:PROC
EXTRN	__imp__DisableThreadLibraryCalls@4:PROC
EXTRN	__imp__GetModuleHandleA@4:PROC
EXTRN	__imp__GetProcAddress@8:PROC
EXTRN	_swprintf_s:PROC
EXTRN	?GetRandomBytes@@YGHPAEK@Z:PROC			; GetRandomBytes
EXTRN	?ReadRegistrySettings@@YGKXZ:PROC		; ReadRegistrySettings
EXTRN	?ActivationResponse@@YGHHPAEPAHPAPAE@Z:PROC	; ActivationResponse
EXTRN	@__CheckForDebuggerJustMyCode@4:PROC
EXTRN	__chkstk:PROC
EXTRN	?Settings@@3UKMSServerSettings@@A:BYTE		; Settings
;	COMDAT ??_C@_1GC@IBFPKKP@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1GC@IBFPKKP@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'D', 00H
	DB	'l', 00H, 'l', 00H, 'M', 00H, 'a', 00H, 'i', 00H, 'n', 00H, ' '
	DB	00H, 'e', 00H, 'n', 00H, 't', 00H, 'r', 00H, 'y', 00H, '.', 00H
	DB	' ', 00H, '[', 00H, 'n', 00H, 'R', 00H, 'e', 00H, 'a', 00H, 's'
	DB	00H, 'o', 00H, 'n', 00H, ':', 00H, ' ', 00H, '%', 00H, 'u', 00H
	DB	']', 00H, 0aH, 00H, 00H, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_1KM@MANCCKDA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1KM@MANCCKDA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'R', 00H
	DB	'e', 00H, 'p', 00H, 'l', 00H, 'a', 00H, 'c', 00H, 'e', 00H, 'd'
	DB	00H, ' ', 00H, '%', 00H, 'S', 00H, ' ', 00H, 'i', 00H, 'm', 00H
	DB	'p', 00H, 'o', 00H, 'r', 00H, 't', 00H, ' ', 00H, '0', 00H, 'x'
	DB	00H, '%', 00H, 'p', 00H, ' ', 00H, '@', 00H, ' ', 00H, '0', 00H
	DB	'x', 00H, '%', 00H, 'p', 00H, ' ', 00H, 'w', 00H, 'i', 00H, 't'
	DB	00H, 'h', 00H, ' ', 00H, 'h', 00H, 'o', 00H, 'o', 00H, 'k', 00H
	DB	' ', 00H, 'e', 00H, 'n', 00H, 't', 00H, 'r', 00H, 'y', 00H, ' '
	DB	00H, '0', 00H, 'x', 00H, '%', 00H, 'p', 00H, ' ', 00H, 'i', 00H
	DB	'n', 00H, ' ', 00H, 'b', 00H, 'a', 00H, 's', 00H, 'e', 00H, ' '
	DB	00H, '0', 00H, 'x', 00H, '%', 00H, 'p', 00H, '.', 00H, 0aH, 00H
	DB	00H, 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_1BDG@BEEGGHPN@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1BDG@BEEGGHPN@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'p', 00H
	DB	'S', 00H, 't', 00H, 'u', 00H, 'b', 00H, 'D', 00H, 'e', 00H, 's'
	DB	00H, 'c', 00H, 'r', 00H, 'i', 00H, 'p', 00H, 't', 00H, 'o', 00H
	DB	'r', 00H, ' ', 00H, '=', 00H, ' ', 00H, '0', 00H, 'x', 00H, '%'
	DB	00H, 'p', 00H, ',', 00H, ' ', 00H, 'p', 00H, 'F', 00H, 'o', 00H
	DB	'r', 00H, 'm', 00H, 'a', 00H, 't', 00H, ' ', 00H, '=', 00H, ' '
	DB	00H, '0', 00H, 'x', 00H, '%', 00H, 'p', 00H, ',', 00H, ' ', 00H
	DB	'B', 00H, 'i', 00H, 'n', 00H, 'd', 00H, 'i', 00H, 'n', 00H, 'g'
	DB	00H, ' ', 00H, '=', 00H, ' ', 00H, '0', 00H, 'x', 00H, '%', 00H
	DB	'p', 00H, ',', 00H, ' ', 00H, 'r', 00H, 'e', 00H, 'q', 00H, 'u'
	DB	00H, 'e', 00H, 's', 00H, 't', 00H, 'S', 00H, 'i', 00H, 'z', 00H
	DB	'e', 00H, ' ', 00H, '=', 00H, ' ', 00H, '%', 00H, 'd', 00H, ','
	DB	00H, ' ', 00H, 'r', 00H, 'e', 00H, 's', 00H, 'u', 00H, 'e', 00H
	DB	's', 00H, 't', 00H, 'D', 00H, 'a', 00H, 't', 00H, 'a', 00H, ' '
	DB	00H, '=', 00H, ' ', 00H, '0', 00H, 'x', 00H, '%', 00H, 'p', 00H
	DB	',', 00H, ' ', 00H, 'r', 00H, 'e', 00H, 's', 00H, 'p', 00H, 'o'
	DB	00H, 'n', 00H, 's', 00H, 'e', 00H, 'S', 00H, 'i', 00H, 'z', 00H
	DB	'e', 00H, ' ', 00H, '=', 00H, ' ', 00H, '0', 00H, 'x', 00H, '%'
	DB	00H, 'p', 00H, ',', 00H, ' ', 00H, 'r', 00H, 'e', 00H, 's', 00H
	DB	'p', 00H, 'o', 00H, 'n', 00H, 's', 00H, 'e', 00H, 'D', 00H, 'a'
	DB	00H, 't', 00H, 'a', 00H, ' ', 00H, '=', 00H, ' ', 00H, '0', 00H
	DB	'x', 00H, '%', 00H, 'p', 00H, 0aH, 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1FE@FPIONGCM@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1FE@FPIONGCM@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'N', 00H
	DB	'd', 00H, 'r', 00H, 'C', 00H, 'l', 00H, 'i', 00H, 'e', 00H, 'n'
	DB	00H, 't', 00H, 'C', 00H, 'a', 00H, 'l', 00H, 'l', 00H, '2', 00H
	DB	' ', 00H, 'c', 00H, 'a', 00H, 'l', 00H, 'l', 00H, 'e', 00H, 'd'
	DB	00H, 0aH, 00H, 00H, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_1HG@MBEKBOEL@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1HG@MBEKBOEL@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'E', 00H
	DB	'm', 00H, 'u', 00H, 'l', 00H, 'a', 00H, 't', 00H, 'i', 00H, 'n'
	DB	00H, 'g', 00H, ' ', 00H, 'S', 00H, 'e', 00H, 'r', 00H, 'v', 00H
	DB	'e', 00H, 'r', 00H, '.', 00H, '.', 00H, '.', 00H, ' ', 00H, 'A'
	DB	00H, 'c', 00H, 't', 00H, 'i', 00H, 'v', 00H, 'a', 00H, 't', 00H
	DB	'i', 00H, 'o', 00H, 'n', 00H, ' ', 00H, 'F', 00H, 'a', 00H, 'i'
	DB	00H, 'l', 00H, 'e', 00H, 'd', 00H, '!', 00H, 0aH, 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1HI@HFEFOPKC@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1HI@HFEFOPKC@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'E', 00H
	DB	'm', 00H, 'u', 00H, 'l', 00H, 'a', 00H, 't', 00H, 'i', 00H, 'n'
	DB	00H, 'g', 00H, ' ', 00H, 'S', 00H, 'e', 00H, 'r', 00H, 'v', 00H
	DB	'e', 00H, 'r', 00H, '.', 00H, '.', 00H, '.', 00H, ' ', 00H, 'A'
	DB	00H, 'c', 00H, 't', 00H, 'i', 00H, 'v', 00H, 'a', 00H, 't', 00H
	DB	'i', 00H, 'o', 00H, 'n', 00H, ' ', 00H, 'S', 00H, 'u', 00H, 'c'
	DB	00H, 'c', 00H, 'e', 00H, 's', 00H, 's', 00H, '!', 00H, 0aH, 00H
	DB	00H, 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_1HE@KAFLNIFK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1HE@KAFLNIFK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'E', 00H
	DB	'm', 00H, 'u', 00H, 'l', 00H, 'a', 00H, 't', 00H, 'i', 00H, 'n'
	DB	00H, 'g', 00H, ' ', 00H, 'S', 00H, 'e', 00H, 'r', 00H, 'v', 00H
	DB	'e', 00H, 'r', 00H, '.', 00H, '.', 00H, '.', 00H, ' ', 00H, 'W'
	DB	00H, 'r', 00H, 'i', 00H, 't', 00H, 'i', 00H, 'n', 00H, 'g', 00H
	DB	' ', 00H, 'R', 00H, 'e', 00H, 's', 00H, 'p', 00H, 'o', 00H, 'n'
	DB	00H, 's', 00H, 'e', 00H, '!', 00H, 0aH, 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1BFE@HBFGDEEA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1BFE@HBFGDEEA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'p', 00H
	DB	'S', 00H, 't', 00H, 'u', 00H, 'b', 00H, 'D', 00H, 'e', 00H, 's'
	DB	00H, 'c', 00H, 'r', 00H, 'i', 00H, 'p', 00H, 't', 00H, 'o', 00H
	DB	'r', 00H, ' ', 00H, '=', 00H, ' ', 00H, '0', 00H, 'x', 00H, '%'
	DB	00H, 'p', 00H, ',', 00H, ' ', 00H, 'p', 00H, 'F', 00H, 'o', 00H
	DB	'r', 00H, 'm', 00H, 'a', 00H, 't', 00H, ' ', 00H, '=', 00H, ' '
	DB	00H, '0', 00H, 'x', 00H, '%', 00H, 'p', 00H, ',', 00H, ' ', 00H
	DB	'p', 00H, 'A', 00H, 's', 00H, 'y', 00H, 'n', 00H, 'c', 00H, ' '
	DB	00H, '=', 00H, ' ', 00H, '0', 00H, 'x', 00H, '%', 00H, 'p', 00H
	DB	',', 00H, ' ', 00H, 'B', 00H, 'i', 00H, 'n', 00H, 'd', 00H, 'i'
	DB	00H, 'n', 00H, 'g', 00H, ' ', 00H, '=', 00H, ' ', 00H, '0', 00H
	DB	'x', 00H, '%', 00H, 'p', 00H, ',', 00H, ' ', 00H, 'r', 00H, 'e'
	DB	00H, 'q', 00H, 'u', 00H, 'e', 00H, 's', 00H, 't', 00H, 'S', 00H
	DB	'i', 00H, 'z', 00H, 'e', 00H, ' ', 00H, '=', 00H, ' ', 00H, '%'
	DB	00H, 'd', 00H, ',', 00H, ' ', 00H, 'r', 00H, 'e', 00H, 's', 00H
	DB	'u', 00H, 'e', 00H, 's', 00H, 't', 00H, 'D', 00H, 'a', 00H, 't'
	DB	00H, 'a', 00H, ' ', 00H, '=', 00H, ' ', 00H, '0', 00H, 'x', 00H
	DB	'%', 00H, 'p', 00H, ',', 00H, ' ', 00H, 'r', 00H, 'e', 00H, 's'
	DB	00H, 'p', 00H, 'o', 00H, 'n', 00H, 's', 00H, 'e', 00H, 'S', 00H
	DB	'i', 00H, 'z', 00H, 'e', 00H, ' ', 00H, '=', 00H, ' ', 00H, '0'
	DB	00H, 'x', 00H, '%', 00H, 'p', 00H, ',', 00H, ' ', 00H, 'r', 00H
	DB	'e', 00H, 's', 00H, 'p', 00H, 'o', 00H, 'n', 00H, 's', 00H, 'e'
	DB	00H, 'D', 00H, 'a', 00H, 't', 00H, 'a', 00H, ' ', 00H, '=', 00H
	DB	' ', 00H, '0', 00H, 'x', 00H, '%', 00H, 'p', 00H, 0aH, 00H, 00H
	DB	00H						; `string'
CONST	ENDS
;	COMDAT ??_C@_1FM@FFJCOKGI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1FM@FFJCOKGI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'N', 00H
	DB	'd', 00H, 'r', 00H, 'A', 00H, 's', 00H, 'y', 00H, 'n', 00H, 'c'
	DB	00H, 'C', 00H, 'l', 00H, 'i', 00H, 'e', 00H, 'n', 00H, 't', 00H
	DB	'C', 00H, 'a', 00H, 'l', 00H, 'l', 00H, ' ', 00H, 'c', 00H, 'a'
	DB	00H, 'l', 00H, 'l', 00H, 'e', 00H, 'd', 00H, 0aH, 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1HG@EPAGGJO@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1HG@EPAGGJO@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'E', 00H
	DB	'm', 00H, 'u', 00H, 'l', 00H, 'a', 00H, 't', 00H, 'i', 00H, 'n'
	DB	00H, 'g', 00H, ' ', 00H, 'S', 00H, 'e', 00H, 'r', 00H, 'v', 00H
	DB	'e', 00H, 'r', 00H, '.', 00H, '.', 00H, '.', 00H, ' ', 00H, 'R'
	DB	00H, 'e', 00H, 't', 00H, 'u', 00H, 'r', 00H, 'n', 00H, ' ', 00H
	DB	'R', 00H, 'P', 00H, 'C', 00H, '_', 00H, 'S', 00H, '_', 00H, 'O'
	DB	00H, 'K', 00H, '.', 00H, '.', 00H, '.', 00H, 0aH, 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1HG@CMDJOPCN@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1HG@CMDJOPCN@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'E', 00H
	DB	'm', 00H, 'u', 00H, 'l', 00H, 'a', 00H, 't', 00H, 'i', 00H, 'n'
	DB	00H, 'g', 00H, ' ', 00H, 'S', 00H, 'e', 00H, 'r', 00H, 'v', 00H
	DB	'e', 00H, 'r', 00H, '.', 00H, '.', 00H, '.', 00H, ' ', 00H, 'S'
	DB	00H, 'a', 00H, 'v', 00H, 'e', 00H, 'd', 00H, ' ', 00H, 'A', 00H
	DB	's', 00H, 'y', 00H, 'n', 00H, 'c', 00H, ' ', 00H, 'H', 00H, 'a'
	DB	00H, 'n', 00H, 'd', 00H, 'l', 00H, 'e', 00H, 0aH, 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1EO@KEMOBAPK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1EO@KEMOBAPK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'F', 00H
	DB	'r', 00H, 'e', 00H, 'e', 00H, ' ', 00H, 'C', 00H, 'o', 00H, 'n'
	DB	00H, 'n', 00H, 'e', 00H, 'c', 00H, 't', 00H, 'i', 00H, 'o', 00H
	DB	'n', 00H, '.', 00H, '.', 00H, '.', 00H, 0aH, 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1FE@FENPFILD@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1FE@FENPFILD@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'F', 00H
	DB	'r', 00H, 'e', 00H, 'e', 00H, ' ', 00H, 'S', 00H, 't', 00H, 'r'
	DB	00H, 'i', 00H, 'n', 00H, 'g', 00H, 'B', 00H, 'i', 00H, 'n', 00H
	DB	'd', 00H, 'i', 00H, 'n', 00H, 'g', 00H, '.', 00H, '.', 00H, '.'
	DB	00H, 0aH, 00H, 00H, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_1MG@BBLFGBJD@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1MG@BBLFGBJD@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'R', 00H
	DB	'p', 00H, 'c', 00H, 'B', 00H, 'i', 00H, 'n', 00H, 'd', 00H, 'i'
	DB	00H, 'n', 00H, 'g', 00H, 'F', 00H, 'r', 00H, 'o', 00H, 'm', 00H
	DB	'S', 00H, 't', 00H, 'r', 00H, 'i', 00H, 'n', 00H, 'g', 00H, 'B'
	DB	00H, 'i', 00H, 'n', 00H, 'd', 00H, 'i', 00H, 'n', 00H, 'g', 00H
	DB	'W', 00H, ' ', 00H, 'c', 00H, 'a', 00H, 'l', 00H, 'l', 00H, 'e'
	DB	00H, 'd', 00H, ' ', 00H, '[', 00H, 'S', 00H, 't', 00H, 'r', 00H
	DB	'i', 00H, 'n', 00H, 'g', 00H, 'B', 00H, 'i', 00H, 'n', 00H, 'd'
	DB	00H, 'i', 00H, 'n', 00H, 'g', 00H, ':', 00H, ' ', 00H, '%', 00H
	DB	's', 00H, ',', 00H, ' ', 00H, 'B', 00H, 'i', 00H, 'n', 00H, 'd'
	DB	00H, 'i', 00H, 'n', 00H, 'g', 00H, ':', 00H, ' ', 00H, '0', 00H
	DB	'x', 00H, '%', 00H, 'p', 00H, ' ', 00H, '@', 00H, ' ', 00H, '0'
	DB	00H, 'x', 00H, '%', 00H, 'p', 00H, ']', 00H, '.', 00H, 0aH, 00H
	DB	00H, 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_1HO@OCCPDHFI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1HO@OCCPDHFI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'E', 00H
	DB	'm', 00H, 'u', 00H, 'l', 00H, 'a', 00H, 't', 00H, 'i', 00H, 'n'
	DB	00H, 'g', 00H, ' ', 00H, 'S', 00H, 'e', 00H, 'r', 00H, 'v', 00H
	DB	'e', 00H, 'r', 00H, '.', 00H, '.', 00H, '.', 00H, ' ', 00H, 'R'
	DB	00H, 'e', 00H, 't', 00H, 'u', 00H, 'r', 00H, 'n', 00H, ' ', 00H
	DB	'f', 00H, 'a', 00H, 'k', 00H, 'e', 00H, ' ', 00H, 'b', 00H, 'i'
	DB	00H, 'n', 00H, 'd', 00H, 'i', 00H, 'n', 00H, 'g', 00H, '.', 00H
	DB	'.', 00H, '.', 00H, 0aH, 00H, 00H, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_1GO@DBPOPFCA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1GO@DBPOPFCA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'R', 00H
	DB	'e', 00H, 'p', 00H, 'l', 00H, 'a', 00H, 'c', 00H, 'e', 00H, 'd'
	DB	00H, ' ', 00H, 'N', 00H, 'e', 00H, 't', 00H, 'w', 00H, 'o', 00H
	DB	'r', 00H, 'k', 00H, 'A', 00H, 'd', 00H, 'd', 00H, 'r', 00H, ' '
	DB	00H, 'f', 00H, 'r', 00H, 'o', 00H, 'm', 00H, ' ', 00H, '%', 00H
	DB	's', 00H, ' ', 00H, 't', 00H, 'o', 00H, ' ', 00H, '%', 00H, 's'
	DB	00H, 0aH, 00H, 00H, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_1BE@KGBJBGOH@?$AA1?$AA2?$AA7?$AA?4?$AA0?$AA?4?$AA0?$AA?4?$AA1@
CONST	SEGMENT
??_C@_1BE@KGBJBGOH@?$AA1?$AA2?$AA7?$AA?4?$AA0?$AA?4?$AA0?$AA?4?$AA1@ DB '1'
	DB	00H, '2', 00H, '7', 00H, '.', 00H, '0', 00H, '.', 00H, '0', 00H
	DB	'.', 00H, '1', 00H, 00H, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_1BE@LJLJKOKP@?$AA?$CF?$AAs?$AA?3?$AA?$CF?$AAs?$AA?$FL?$AA?$CF?$AAs?$AA?$FN@
CONST	SEGMENT
??_C@_1BE@LJLJKOKP@?$AA?$CF?$AAs?$AA?3?$AA?$CF?$AAs?$AA?$FL?$AA?$CF?$AAs?$AA?$FN@ DB '%'
	DB	00H, 's', 00H, ':', 00H, '%', 00H, 's', 00H, '[', 00H, '%', 00H
	DB	's', 00H, ']', 00H, 00H, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_1HO@DNFNIJBK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1HO@DNFNIJBK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'C', 00H
	DB	'o', 00H, 'n', 00H, 'n', 00H, 'e', 00H, 'c', 00H, 't', 00H, 'i'
	DB	00H, 'o', 00H, 'n', 00H, ' ', 00H, 'D', 00H, 'e', 00H, 't', 00H
	DB	'e', 00H, 'c', 00H, 't', 00H, 'e', 00H, 'd', 00H, '.', 00H, '.'
	DB	00H, '.', 00H, ' ', 00H, 'E', 00H, 'm', 00H, 'u', 00H, 'l', 00H
	DB	'a', 00H, 't', 00H, 'i', 00H, 'n', 00H, 'g', 00H, ' ', 00H, 'S'
	DB	00H, 'e', 00H, 'r', 00H, 'v', 00H, 'e', 00H, 'r', 00H, '.', 00H
	DB	'.', 00H, '.', 00H, 0aH, 00H, 00H, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_1BK@BPGFLIHL@?$AAn?$AAc?$AAa?$AAc?$AAn?$AA_?$AAi?$AAp?$AA_?$AAt?$AAc?$AAp@
CONST	SEGMENT
??_C@_1BK@BPGFLIHL@?$AAn?$AAc?$AAa?$AAc?$AAn?$AA_?$AAi?$AAp?$AA_?$AAt?$AAc?$AAp@ DB 'n'
	DB	00H, 'c', 00H, 'a', 00H, 'c', 00H, 'n', 00H, '_', 00H, 'i', 00H
	DB	'p', 00H, '_', 00H, 't', 00H, 'c', 00H, 'p', 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1ME@JMHPJKGI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1ME@JMHPJKGI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'R', 00H
	DB	'p', 00H, 'c', 00H, 'S', 00H, 't', 00H, 'r', 00H, 'i', 00H, 'n'
	DB	00H, 'g', 00H, 'B', 00H, 'i', 00H, 'n', 00H, 'd', 00H, 'i', 00H
	DB	'n', 00H, 'g', 00H, 'C', 00H, 'o', 00H, 'm', 00H, 'p', 00H, 'o'
	DB	00H, 's', 00H, 'e', 00H, 'W', 00H, ' ', 00H, 'c', 00H, 'a', 00H
	DB	'l', 00H, 'l', 00H, 'e', 00H, 'd', 00H, ' ', 00H, '[', 00H, 'P'
	DB	00H, 'r', 00H, 'o', 00H, 't', 00H, 'S', 00H, 'e', 00H, 'q', 00H
	DB	':', 00H, ' ', 00H, '%', 00H, 's', 00H, ',', 00H, ' ', 00H, 'N'
	DB	00H, 'e', 00H, 't', 00H, 'W', 00H, 'o', 00H, 'r', 00H, 'k', 00H
	DB	'A', 00H, 'd', 00H, 'd', 00H, 'r', 00H, ':', 00H, ' ', 00H, '%'
	DB	00H, 's', 00H, ',', 00H, ' ', 00H, 'E', 00H, 'n', 00H, 'd', 00H
	DB	'P', 00H, 'o', 00H, 'i', 00H, 'n', 00H, 't', 00H, ':', 00H, ' '
	DB	00H, '%', 00H, 's', 00H, ']', 00H, '.', 00H, 0aH, 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1HK@KJBODIAK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1HK@KJBODIAK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'N', 00H
	DB	'o', 00H, 't', 00H, ' ', 00H, 'a', 00H, ' ', 00H, 't', 00H, 'a'
	DB	00H, 'r', 00H, 'g', 00H, 'e', 00H, 't', 00H, ' ', 00H, 'm', 00H
	DB	'o', 00H, 'd', 00H, 'u', 00H, 'l', 00H, 'e', 00H, '.', 00H, ' '
	DB	00H, 'S', 00H, 'k', 00H, 'i', 00H, 'p', 00H, 'p', 00H, 'e', 00H
	DB	'd', 00H, ' ', 00H, 'p', 00H, 'a', 00H, 't', 00H, 'c', 00H, 'h'
	DB	00H, 'i', 00H, 'n', 00H, 'g', 00H, '.', 00H, '.', 00H, '.', 00H
	DB	0aH, 00H, 00H, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_1BI@IDEMALCL@?$AAS?$AAP?$AAP?$AAO?$AAB?$AAJ?$AAS?$AA?4?$AAD?$AAL?$AAL@
CONST	SEGMENT
??_C@_1BI@IDEMALCL@?$AAS?$AAP?$AAP?$AAO?$AAB?$AAJ?$AAS?$AA?4?$AAD?$AAL?$AAL@ DB 'S'
	DB	00H, 'P', 00H, 'P', 00H, 'O', 00H, 'B', 00H, 'J', 00H, 'S', 00H
	DB	'.', 00H, 'D', 00H, 'L', 00H, 'L', 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1BK@MGFBEOIA@?$AAO?$AAS?$AAP?$AAP?$AAO?$AAB?$AAJ?$AAS?$AA?4?$AAD?$AAL?$AAL@
CONST	SEGMENT
??_C@_1BK@MGFBEOIA@?$AAO?$AAS?$AAP?$AAP?$AAO?$AAB?$AAJ?$AAS?$AA?4?$AAD?$AAL?$AAL@ DB 'O'
	DB	00H, 'S', 00H, 'P', 00H, 'P', 00H, 'O', 00H, 'B', 00H, 'J', 00H
	DB	'S', 00H, '.', 00H, 'D', 00H, 'L', 00H, 'L', 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1IM@KEMAINMH@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
CONST	SEGMENT
??_C@_1IM@KEMAINMH@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@ DB '['
	DB	00H, 'S', 00H, 'p', 00H, 'p', 00H, 'E', 00H, 'x', 00H, 't', 00H
	DB	'C', 00H, 'o', 00H, 'm', 00H, 'O', 00H, 'b', 00H, 'j', 00H, 'H'
	DB	00H, 'o', 00H, 'o', 00H, 'k', 00H, ']', 00H, ' ', 00H, 'L', 00H
	DB	'o', 00H, 'a', 00H, 'd', 00H, 'L', 00H, 'i', 00H, 'b', 00H, 'r'
	DB	00H, 'a', 00H, 'r', 00H, 'y', 00H, 'W', 00H, ' ', 00H, 'c', 00H
	DB	'a', 00H, 'l', 00H, 'l', 00H, 'e', 00H, 'd', 00H, '.', 00H, ' '
	DB	00H, '[', 00H, 'l', 00H, 'p', 00H, 'F', 00H, 'i', 00H, 'l', 00H
	DB	'e', 00H, 'N', 00H, 'a', 00H, 'm', 00H, 'e', 00H, ':', 00H, ' '
	DB	00H, '%', 00H, 's', 00H, ',', 00H, ' ', 00H, 'b', 00H, 'a', 00H
	DB	's', 00H, 'e', 00H, ':', 00H, ' ', 00H, '0', 00H, 'x', 00H, '%'
	DB	00H, 'p', 00H, ']', 00H, 0aH, 00H, 00H, 00H	; `string'
CONST	ENDS
; Function compile flags: /Odt
;	COMDAT __JustMyCode_Default
_TEXT	SEGMENT
__JustMyCode_Default PROC				; COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	5d		 pop	 ebp
  00004	c3		 ret	 0
__JustMyCode_Default ENDP
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT _DllMain@12
_TEXT	SEGMENT
tv78 = -1224						; size = 4
tv69 = -1224						; size = 4
_bRet$ = -1028						; size = 4
_c$1 = -1024						; size = 1024
_hinstDLL$ = 8						; size = 4
_fdwReason$ = 12					; size = 4
_lpvReserved$ = 16					; size = 4
_DllMain@12 PROC					; COMDAT

; 548  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c8 04 00
	00		 sub	 esp, 1224		; 000004c8H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00011	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 549  : 	UNREFERENCED_PARAMETER(hinstDLL);
; 550  : 	UNREFERENCED_PARAMETER(lpvReserved);
; 551  : 
; 552  : 	OutputDebugStringEx(L"[SppExtComObjHook] DllMain entry. [nReason: %u]\n", fdwReason);

  00016	8b 45 0c	 mov	 eax, DWORD PTR _fdwReason$[ebp]
  00019	50		 push	 eax
  0001a	68 00 00 00 00	 push	 OFFSET ??_C@_1GC@IBFPKKP@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  0001f	68 00 02 00 00	 push	 512			; 00000200H
  00024	8d 8d 00 fc ff
	ff		 lea	 ecx, DWORD PTR _c$1[ebp]
  0002a	51		 push	 ecx
  0002b	e8 00 00 00 00	 call	 _swprintf_s
  00030	83 c4 10	 add	 esp, 16			; 00000010H
  00033	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  00039	50		 push	 eax
  0003a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 553  : 
; 554  : 	BOOL bRet = TRUE;

  00040	c7 85 fc fb ff
	ff 01 00 00 00	 mov	 DWORD PTR _bRet$[ebp], 1

; 555  : 
; 556  : 	switch (fdwReason)

  0004a	8b 45 0c	 mov	 eax, DWORD PTR _fdwReason$[ebp]
  0004d	89 85 38 fb ff
	ff		 mov	 DWORD PTR tv69[ebp], eax
  00053	83 bd 38 fb ff
	ff 01		 cmp	 DWORD PTR tv69[ebp], 1
  0005a	74 02		 je	 SHORT $LN4@DllMain
  0005c	eb 42		 jmp	 SHORT $LN2@DllMain
$LN4@DllMain:

; 557  : 	{
; 558  : 	case DLL_PROCESS_ATTACH:
; 559  : 		bRet = DisableThreadLibraryCalls(hinstDLL) && PatchIAT(GetModuleHandleA(nullptr));

  0005e	8b 45 08	 mov	 eax, DWORD PTR _hinstDLL$[ebp]
  00061	50		 push	 eax
  00062	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__DisableThreadLibraryCalls@4
  00068	85 c0		 test	 eax, eax
  0006a	74 1e		 je	 SHORT $LN7@DllMain
  0006c	6a 00		 push	 0
  0006e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetModuleHandleA@4
  00074	50		 push	 eax
  00075	e8 00 00 00 00	 call	 ?PatchIAT@@YGHPAUHINSTANCE__@@@Z ; PatchIAT
  0007a	85 c0		 test	 eax, eax
  0007c	74 0c		 je	 SHORT $LN7@DllMain
  0007e	c7 85 38 fb ff
	ff 01 00 00 00	 mov	 DWORD PTR tv78[ebp], 1
  00088	eb 0a		 jmp	 SHORT $LN8@DllMain
$LN7@DllMain:
  0008a	c7 85 38 fb ff
	ff 00 00 00 00	 mov	 DWORD PTR tv78[ebp], 0
$LN8@DllMain:
  00094	8b 8d 38 fb ff
	ff		 mov	 ecx, DWORD PTR tv78[ebp]
  0009a	89 8d fc fb ff
	ff		 mov	 DWORD PTR _bRet$[ebp], ecx
$LN2@DllMain:

; 560  : 		break;
; 561  : 	case DLL_THREAD_ATTACH:
; 562  : 	case DLL_THREAD_DETACH:
; 563  : 	case DLL_PROCESS_DETACH:
; 564  : 		break;
; 565  : 	}
; 566  : 
; 567  : 	return bRet;

  000a0	8b 85 fc fb ff
	ff		 mov	 eax, DWORD PTR _bRet$[ebp]

; 568  : }

  000a6	5f		 pop	 edi
  000a7	5e		 pop	 esi
  000a8	5b		 pop	 ebx
  000a9	8b e5		 mov	 esp, ebp
  000ab	5d		 pop	 ebp
  000ac	c2 0c 00	 ret	 12			; 0000000cH
_DllMain@12 ENDP
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?PatchIATInternal@@YGHPAUHINSTANCE__@@PAU_APIHook@@@Z
_TEXT	SEGMENT
_flOldProtect$1 = -1056					; size = 4
_c$2 = -1052						; size = 1024
_pfnImportedFunc$3 = -28				; size = 4
_pOrgImageThunkData$4 = -24				; size = 4
_pImageThunkData$5 = -20				; size = 4
_lpDllName$6 = -16					; size = 4
_pImageImportDescriptor$ = -12				; size = 4
_BaseAddress$ = -8					; size = 4
_Original$ = -4						; size = 4
_hModule$ = 8						; size = 4
_APIHookInfo$ = 12					; size = 4
?PatchIATInternal@@YGHPAUHINSTANCE__@@PAU_APIHook@@@Z PROC ; PatchIATInternal, COMDAT

; 477  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec e0 04 00
	00		 sub	 esp, 1248		; 000004e0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00011	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 478  : 	// Get original function addresses being hooked
; 479  : 	FARPROC Original = GetProcAddress(GetModuleHandleA(APIHookInfo->module), APIHookInfo->name);

  00016	8b 45 0c	 mov	 eax, DWORD PTR _APIHookInfo$[ebp]
  00019	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  0001c	51		 push	 ecx
  0001d	8b 55 0c	 mov	 edx, DWORD PTR _APIHookInfo$[ebp]
  00020	8b 02		 mov	 eax, DWORD PTR [edx]
  00022	50		 push	 eax
  00023	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetModuleHandleA@4
  00029	50		 push	 eax
  0002a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetProcAddress@8
  00030	89 45 fc	 mov	 DWORD PTR _Original$[ebp], eax

; 480  : 	if (Original == nullptr)

  00033	83 7d fc 00	 cmp	 DWORD PTR _Original$[ebp], 0
  00037	75 07		 jne	 SHORT $LN8@PatchIATIn

; 481  : 		return FALSE;

  00039	33 c0		 xor	 eax, eax
  0003b	e9 55 01 00 00	 jmp	 $LN1@PatchIATIn
$LN8@PatchIATIn:

; 482  : 
; 483  : 	// Hold original address
; 484  : 	if (APIHookInfo->original == nullptr)

  00040	8b 45 0c	 mov	 eax, DWORD PTR _APIHookInfo$[ebp]
  00043	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  00047	75 09		 jne	 SHORT $LN9@PatchIATIn

; 485  : 		APIHookInfo->original = Original;

  00049	8b 45 0c	 mov	 eax, DWORD PTR _APIHookInfo$[ebp]
  0004c	8b 4d fc	 mov	 ecx, DWORD PTR _Original$[ebp]
  0004f	89 48 0c	 mov	 DWORD PTR [eax+12], ecx
$LN9@PatchIATIn:

; 486  : 
; 487  : 	// Get base address of our process primary module
; 488  : 	ULONG_PTR BaseAddress = (ULONG_PTR)hModule;

  00052	8b 45 08	 mov	 eax, DWORD PTR _hModule$[ebp]
  00055	89 45 f8	 mov	 DWORD PTR _BaseAddress$[ebp], eax

; 489  : 
; 490  : 	// Get import table
; 491  : 	PIMAGE_IMPORT_DESCRIPTOR pImageImportDescriptor = GetImportDescriptor(hModule);

  00058	8b 45 08	 mov	 eax, DWORD PTR _hModule$[ebp]
  0005b	50		 push	 eax
  0005c	e8 00 00 00 00	 call	 ?GetImportDescriptor@@YGPAU_IMAGE_IMPORT_DESCRIPTOR@@PAUHINSTANCE__@@@Z ; GetImportDescriptor
  00061	89 45 f4	 mov	 DWORD PTR _pImageImportDescriptor$[ebp], eax

; 492  : 
; 493  : 	if (pImageImportDescriptor == nullptr)

  00064	83 7d f4 00	 cmp	 DWORD PTR _pImageImportDescriptor$[ebp], 0
  00068	75 07		 jne	 SHORT $LN10@PatchIATIn

; 494  : 		return FALSE;

  0006a	33 c0		 xor	 eax, eax
  0006c	e9 24 01 00 00	 jmp	 $LN1@PatchIATIn
$LN10@PatchIATIn:

; 495  : 
; 496  : 	// Search through import table
; 497  : 	for (; pImageImportDescriptor->Name; pImageImportDescriptor++)

  00071	eb 09		 jmp	 SHORT $LN4@PatchIATIn
$LN2@PatchIATIn:
  00073	8b 45 f4	 mov	 eax, DWORD PTR _pImageImportDescriptor$[ebp]
  00076	83 c0 14	 add	 eax, 20			; 00000014H
  00079	89 45 f4	 mov	 DWORD PTR _pImageImportDescriptor$[ebp], eax
$LN4@PatchIATIn:
  0007c	8b 45 f4	 mov	 eax, DWORD PTR _pImageImportDescriptor$[ebp]
  0007f	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  00083	0f 84 07 01 00
	00		 je	 $LN3@PatchIATIn

; 498  : 	{
; 499  : 
; 500  : 		LPCSTR lpDllName = (LPCSTR)(BaseAddress + pImageImportDescriptor->Name);

  00089	8b 45 f4	 mov	 eax, DWORD PTR _pImageImportDescriptor$[ebp]
  0008c	8b 4d f8	 mov	 ecx, DWORD PTR _BaseAddress$[ebp]
  0008f	03 48 0c	 add	 ecx, DWORD PTR [eax+12]
  00092	89 4d f0	 mov	 DWORD PTR _lpDllName$6[ebp], ecx

; 501  : 
; 502  : 		if (_stricmp(lpDllName, APIHookInfo->module))

  00095	8b 45 0c	 mov	 eax, DWORD PTR _APIHookInfo$[ebp]
  00098	8b 08		 mov	 ecx, DWORD PTR [eax]
  0009a	51		 push	 ecx
  0009b	8b 55 f0	 mov	 edx, DWORD PTR _lpDllName$6[ebp]
  0009e	52		 push	 edx
  0009f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp___stricmp
  000a5	83 c4 08	 add	 esp, 8
  000a8	85 c0		 test	 eax, eax
  000aa	74 02		 je	 SHORT $LN11@PatchIATIn

; 503  : 			continue;

  000ac	eb c5		 jmp	 SHORT $LN2@PatchIATIn
$LN11@PatchIATIn:

; 504  : 
; 505  : 		PIMAGE_THUNK_DATA pImageThunkData = (PIMAGE_THUNK_DATA)(BaseAddress + pImageImportDescriptor->FirstThunk);

  000ae	8b 45 f4	 mov	 eax, DWORD PTR _pImageImportDescriptor$[ebp]
  000b1	8b 4d f8	 mov	 ecx, DWORD PTR _BaseAddress$[ebp]
  000b4	03 48 10	 add	 ecx, DWORD PTR [eax+16]
  000b7	89 4d ec	 mov	 DWORD PTR _pImageThunkData$5[ebp], ecx

; 506  : 		PIMAGE_THUNK_DATA pOrgImageThunkData = (PIMAGE_THUNK_DATA)(BaseAddress + pImageImportDescriptor->OriginalFirstThunk);

  000ba	8b 45 f4	 mov	 eax, DWORD PTR _pImageImportDescriptor$[ebp]
  000bd	8b 4d f8	 mov	 ecx, DWORD PTR _BaseAddress$[ebp]
  000c0	03 08		 add	 ecx, DWORD PTR [eax]
  000c2	89 4d e8	 mov	 DWORD PTR _pOrgImageThunkData$4[ebp], ecx

; 507  : 
; 508  : 		for (; pImageThunkData->u1.Function; pImageThunkData++, pOrgImageThunkData++)

  000c5	eb 12		 jmp	 SHORT $LN7@PatchIATIn
$LN5@PatchIATIn:
  000c7	8b 45 ec	 mov	 eax, DWORD PTR _pImageThunkData$5[ebp]
  000ca	83 c0 04	 add	 eax, 4
  000cd	89 45 ec	 mov	 DWORD PTR _pImageThunkData$5[ebp], eax
  000d0	8b 4d e8	 mov	 ecx, DWORD PTR _pOrgImageThunkData$4[ebp]
  000d3	83 c1 04	 add	 ecx, 4
  000d6	89 4d e8	 mov	 DWORD PTR _pOrgImageThunkData$4[ebp], ecx
$LN7@PatchIATIn:
  000d9	8b 45 ec	 mov	 eax, DWORD PTR _pImageThunkData$5[ebp]
  000dc	83 38 00	 cmp	 DWORD PTR [eax], 0
  000df	0f 84 a6 00 00
	00		 je	 $LN6@PatchIATIn

; 509  : 		{
; 510  : 			FARPROC pfnImportedFunc = (FARPROC)(pImageThunkData->u1.Function);

  000e5	8b 45 ec	 mov	 eax, DWORD PTR _pImageThunkData$5[ebp]
  000e8	8b 08		 mov	 ecx, DWORD PTR [eax]
  000ea	89 4d e4	 mov	 DWORD PTR _pfnImportedFunc$3[ebp], ecx

; 511  : 
; 512  : 			// Patch
; 513  : 			if (pfnImportedFunc == Original)

  000ed	8b 45 e4	 mov	 eax, DWORD PTR _pfnImportedFunc$3[ebp]
  000f0	3b 45 fc	 cmp	 eax, DWORD PTR _Original$[ebp]
  000f3	0f 85 8d 00 00
	00		 jne	 $LN12@PatchIATIn

; 514  : 			{
; 515  : 				OutputDebugStringEx(L"[SppExtComObjHook] Replaced %S import 0x%p @ 0x%p with hook entry 0x%p in base 0x%p.\n",

  000f9	8b 45 08	 mov	 eax, DWORD PTR _hModule$[ebp]
  000fc	50		 push	 eax
  000fd	8b 4d 0c	 mov	 ecx, DWORD PTR _APIHookInfo$[ebp]
  00100	8b 51 08	 mov	 edx, DWORD PTR [ecx+8]
  00103	52		 push	 edx
  00104	8b 45 ec	 mov	 eax, DWORD PTR _pImageThunkData$5[ebp]
  00107	50		 push	 eax
  00108	8b 4d ec	 mov	 ecx, DWORD PTR _pImageThunkData$5[ebp]
  0010b	8b 11		 mov	 edx, DWORD PTR [ecx]
  0010d	52		 push	 edx
  0010e	8b 45 0c	 mov	 eax, DWORD PTR _APIHookInfo$[ebp]
  00111	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00114	51		 push	 ecx
  00115	68 00 00 00 00	 push	 OFFSET ??_C@_1KM@MANCCKDA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  0011a	68 00 02 00 00	 push	 512			; 00000200H
  0011f	8d 95 e4 fb ff
	ff		 lea	 edx, DWORD PTR _c$2[ebp]
  00125	52		 push	 edx
  00126	e8 00 00 00 00	 call	 _swprintf_s
  0012b	83 c4 20	 add	 esp, 32			; 00000020H
  0012e	8d 85 e4 fb ff
	ff		 lea	 eax, DWORD PTR _c$2[ebp]
  00134	50		 push	 eax
  00135	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 516  : 					APIHookInfo->name, (void*)pImageThunkData->u1.Function, (void*)(&pImageThunkData->u1.Function), APIHookInfo->hook, hModule);
; 517  : 				DWORD flOldProtect;
; 518  : 				VirtualProtect(pImageThunkData, sizeof(ULONG_PTR), PAGE_READWRITE, &flOldProtect);

  0013b	8d 85 e0 fb ff
	ff		 lea	 eax, DWORD PTR _flOldProtect$1[ebp]
  00141	50		 push	 eax
  00142	6a 04		 push	 4
  00144	6a 04		 push	 4
  00146	8b 4d ec	 mov	 ecx, DWORD PTR _pImageThunkData$5[ebp]
  00149	51		 push	 ecx
  0014a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__VirtualProtect@16

; 519  : 				WriteProcessMemory(GetCurrentProcess(), pImageThunkData, &APIHookInfo->hook, sizeof(ULONG_PTR), nullptr);

  00150	6a 00		 push	 0
  00152	6a 04		 push	 4
  00154	8b 45 0c	 mov	 eax, DWORD PTR _APIHookInfo$[ebp]
  00157	83 c0 08	 add	 eax, 8
  0015a	50		 push	 eax
  0015b	8b 4d ec	 mov	 ecx, DWORD PTR _pImageThunkData$5[ebp]
  0015e	51		 push	 ecx
  0015f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetCurrentProcess@0
  00165	50		 push	 eax
  00166	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WriteProcessMemory@20

; 520  : 				VirtualProtect(pImageThunkData, sizeof(ULONG_PTR), flOldProtect, &flOldProtect);

  0016c	8d 85 e0 fb ff
	ff		 lea	 eax, DWORD PTR _flOldProtect$1[ebp]
  00172	50		 push	 eax
  00173	8b 8d e0 fb ff
	ff		 mov	 ecx, DWORD PTR _flOldProtect$1[ebp]
  00179	51		 push	 ecx
  0017a	6a 04		 push	 4
  0017c	8b 55 ec	 mov	 edx, DWORD PTR _pImageThunkData$5[ebp]
  0017f	52		 push	 edx
  00180	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__VirtualProtect@16
$LN12@PatchIATIn:

; 521  : 			}
; 522  : 		}

  00186	e9 3c ff ff ff	 jmp	 $LN5@PatchIATIn
$LN6@PatchIATIn:

; 523  : 	}

  0018b	e9 e3 fe ff ff	 jmp	 $LN2@PatchIATIn
$LN3@PatchIATIn:

; 524  : 
; 525  : 	return TRUE;

  00190	b8 01 00 00 00	 mov	 eax, 1
$LN1@PatchIATIn:

; 526  : }

  00195	5f		 pop	 edi
  00196	5e		 pop	 esi
  00197	5b		 pop	 ebx
  00198	8b e5		 mov	 esp, ebp
  0019a	5d		 pop	 ebp
  0019b	c2 08 00	 ret	 8
?PatchIATInternal@@YGHPAUHINSTANCE__@@PAU_APIHook@@@Z ENDP ; PatchIATInternal
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?GetImportDescriptor@@YGPAU_IMAGE_IMPORT_DESCRIPTOR@@PAUHINSTANCE__@@@Z
_TEXT	SEGMENT
_pDosHeader$ = -24					; size = 4
_pb$ = -20						; size = 4
_Address$ = -16						; size = 4
_pDirectory$ = -12					; size = 4
_pOptionalHeader$ = -8					; size = 4
_pNtHeaders$ = -4					; size = 4
_hModule$ = 8						; size = 4
?GetImportDescriptor@@YGPAU_IMAGE_IMPORT_DESCRIPTOR@@PAUHINSTANCE__@@@Z PROC ; GetImportDescriptor, COMDAT

; 449  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  0000e	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 450  : 	PIMAGE_NT_HEADERS pNtHeaders;
; 451  : 	PIMAGE_OPTIONAL_HEADER pOptionalHeader;
; 452  : 	PIMAGE_DATA_DIRECTORY pDirectory;
; 453  : 	ULONG_PTR Address;
; 454  : 	LPBYTE pb = (LPBYTE)hModule;

  00013	8b 45 08	 mov	 eax, DWORD PTR _hModule$[ebp]
  00016	89 45 ec	 mov	 DWORD PTR _pb$[ebp], eax

; 455  : 
; 456  : 	if (((WORD *)pb)[0] != IMAGE_DOS_SIGNATURE)

  00019	b8 02 00 00 00	 mov	 eax, 2
  0001e	6b c8 00	 imul	 ecx, eax, 0
  00021	8b 55 ec	 mov	 edx, DWORD PTR _pb$[ebp]
  00024	0f b7 04 0a	 movzx	 eax, WORD PTR [edx+ecx]
  00028	3d 4d 5a 00 00	 cmp	 eax, 23117		; 00005a4dH
  0002d	74 04		 je	 SHORT $LN2@GetImportD

; 457  : 		return nullptr;

  0002f	33 c0		 xor	 eax, eax
  00031	eb 5d		 jmp	 SHORT $LN1@GetImportD
$LN2@GetImportD:

; 458  : 
; 459  : 	PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)hModule;

  00033	8b 45 08	 mov	 eax, DWORD PTR _hModule$[ebp]
  00036	89 45 e8	 mov	 DWORD PTR _pDosHeader$[ebp], eax

; 460  : 	pNtHeaders = (PIMAGE_NT_HEADERS)(pb + pDosHeader->e_lfanew);

  00039	8b 45 e8	 mov	 eax, DWORD PTR _pDosHeader$[ebp]
  0003c	8b 4d ec	 mov	 ecx, DWORD PTR _pb$[ebp]
  0003f	03 48 3c	 add	 ecx, DWORD PTR [eax+60]
  00042	89 4d fc	 mov	 DWORD PTR _pNtHeaders$[ebp], ecx

; 461  : 
; 462  : 	if (((DWORD *)pNtHeaders)[0] != IMAGE_NT_SIGNATURE)

  00045	b8 04 00 00 00	 mov	 eax, 4
  0004a	6b c8 00	 imul	 ecx, eax, 0
  0004d	8b 55 fc	 mov	 edx, DWORD PTR _pNtHeaders$[ebp]
  00050	81 3c 0a 50 45
	00 00		 cmp	 DWORD PTR [edx+ecx], 17744 ; 00004550H
  00057	74 04		 je	 SHORT $LN3@GetImportD

; 463  : 		return nullptr;

  00059	33 c0		 xor	 eax, eax
  0005b	eb 33		 jmp	 SHORT $LN1@GetImportD
$LN3@GetImportD:

; 464  : 
; 465  : 	pOptionalHeader = &pNtHeaders->OptionalHeader;

  0005d	8b 45 fc	 mov	 eax, DWORD PTR _pNtHeaders$[ebp]
  00060	83 c0 18	 add	 eax, 24			; 00000018H
  00063	89 45 f8	 mov	 DWORD PTR _pOptionalHeader$[ebp], eax

; 466  : 	pDirectory = &pOptionalHeader->DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT];

  00066	b8 08 00 00 00	 mov	 eax, 8
  0006b	c1 e0 00	 shl	 eax, 0
  0006e	8b 4d f8	 mov	 ecx, DWORD PTR _pOptionalHeader$[ebp]
  00071	8d 54 01 60	 lea	 edx, DWORD PTR [ecx+eax+96]
  00075	89 55 f4	 mov	 DWORD PTR _pDirectory$[ebp], edx

; 467  : 	Address = pDirectory->VirtualAddress;

  00078	8b 45 f4	 mov	 eax, DWORD PTR _pDirectory$[ebp]
  0007b	8b 08		 mov	 ecx, DWORD PTR [eax]
  0007d	89 4d f0	 mov	 DWORD PTR _Address$[ebp], ecx

; 468  : 
; 469  : 	if (Address == 0)

  00080	83 7d f0 00	 cmp	 DWORD PTR _Address$[ebp], 0
  00084	75 04		 jne	 SHORT $LN4@GetImportD

; 470  : 		return nullptr;

  00086	33 c0		 xor	 eax, eax
  00088	eb 06		 jmp	 SHORT $LN1@GetImportD
$LN4@GetImportD:

; 471  : 
; 472  : 	return (PIMAGE_IMPORT_DESCRIPTOR)((ULONG_PTR)hModule + Address);

  0008a	8b 45 08	 mov	 eax, DWORD PTR _hModule$[ebp]
  0008d	03 45 f0	 add	 eax, DWORD PTR _Address$[ebp]
$LN1@GetImportD:

; 473  : }

  00090	5f		 pop	 edi
  00091	5e		 pop	 esi
  00092	5b		 pop	 ebx
  00093	8b e5		 mov	 esp, ebp
  00095	5d		 pop	 ebp
  00096	c2 04 00	 ret	 4
?GetImportDescriptor@@YGPAU_IMAGE_IMPORT_DESCRIPTOR@@PAUHINSTANCE__@@@Z ENDP ; GetImportDescriptor
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?PatchIAT@@YGHPAUHINSTANCE__@@@Z
_TEXT	SEGMENT
_i$1 = -8						; size = 4
_bRet$ = -4						; size = 4
_hModule$ = 8						; size = 4
?PatchIAT@@YGHPAUHINSTANCE__@@@Z PROC			; PatchIAT, COMDAT

; 529  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 48	 sub	 esp, 72			; 00000048H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  0000e	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 530  : 	BOOL bRet = TRUE;

  00013	c7 45 fc 01 00
	00 00		 mov	 DWORD PTR _bRet$[ebp], 1

; 531  : 
; 532  : 	for (int i = 0; i < _countof(APIHooks); i++)

  0001a	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _i$1[ebp], 0
  00021	eb 09		 jmp	 SHORT $LN4@PatchIAT
$LN2@PatchIAT:
  00023	8b 45 f8	 mov	 eax, DWORD PTR _i$1[ebp]
  00026	83 c0 01	 add	 eax, 1
  00029	89 45 f8	 mov	 DWORD PTR _i$1[ebp], eax
$LN4@PatchIAT:
  0002c	83 7d f8 09	 cmp	 DWORD PTR _i$1[ebp], 9
  00030	73 24		 jae	 SHORT $LN3@PatchIAT

; 533  : 	{
; 534  : 		if (!PatchIATInternal(hModule, &APIHooks[i]))

  00032	8b 45 f8	 mov	 eax, DWORD PTR _i$1[ebp]
  00035	c1 e0 04	 shl	 eax, 4
  00038	05 00 00 00 00	 add	 eax, OFFSET ?APIHooks@@3PAU_APIHook@@A ; APIHooks
  0003d	50		 push	 eax
  0003e	8b 4d 08	 mov	 ecx, DWORD PTR _hModule$[ebp]
  00041	51		 push	 ecx
  00042	e8 00 00 00 00	 call	 ?PatchIATInternal@@YGHPAUHINSTANCE__@@PAU_APIHook@@@Z ; PatchIATInternal
  00047	85 c0		 test	 eax, eax
  00049	75 09		 jne	 SHORT $LN5@PatchIAT

; 535  : 		{
; 536  : 			bRet = FALSE;

  0004b	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _bRet$[ebp], 0

; 537  : 			break;

  00052	eb 02		 jmp	 SHORT $LN3@PatchIAT
$LN5@PatchIAT:

; 538  : 		}
; 539  : 	}

  00054	eb cd		 jmp	 SHORT $LN2@PatchIAT
$LN3@PatchIAT:

; 540  : 
; 541  : 	return bRet;

  00056	8b 45 fc	 mov	 eax, DWORD PTR _bRet$[ebp]

; 542  : }

  00059	5f		 pop	 edi
  0005a	5e		 pop	 esi
  0005b	5b		 pop	 ebx
  0005c	8b e5		 mov	 esp, ebp
  0005e	5d		 pop	 ebp
  0005f	c2 04 00	 ret	 4
?PatchIAT@@YGHPAUHINSTANCE__@@@Z ENDP			; PatchIAT
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?NdrClientCall2_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ
_TEXT	SEGMENT
$T1 = -5664						; size = 4
_ret$2 = -5148						; size = 4
_c$3 = -5144						; size = 1024
_c$4 = -4120						; size = 1024
_c$5 = -3096						; size = 1024
_c$6 = -2072						; size = 1024
_responseData$ = -1048					; size = 4
_responseSize$ = -1044					; size = 4
_requestData$ = -1040					; size = 4
_requestSize$ = -1036					; size = 4
_Binding$ = -1032					; size = 4
_funcVarList$ = -1028					; size = 4
_c$7 = -1024						; size = 1024
_pStubDescriptor$ = 8					; size = 4
_pFormat$ = 12						; size = 4
?NdrClientCall2_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ PROC ; NdrClientCall2_Hook, COMDAT

; 293  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	b8 20 16 00 00	 mov	 eax, 5664		; 00001620H
  00008	e8 00 00 00 00	 call	 __chkstk
  0000d	53		 push	 ebx
  0000e	56		 push	 esi
  0000f	57		 push	 edi
  00010	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00015	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 294  : 	OutputDebugStringEx(L"[SppExtComObjHook] NdrClientCall2 called\n");

  0001a	68 00 00 00 00	 push	 OFFSET ??_C@_1FE@FPIONGCM@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  0001f	68 00 02 00 00	 push	 512			; 00000200H
  00024	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$7[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 _swprintf_s
  00030	83 c4 0c	 add	 esp, 12			; 0000000cH
  00033	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$7[ebp]
  00039	50		 push	 eax
  0003a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 295  : 
; 296  : #ifdef _WIN64
; 297  : 	va_list ap = nullptr;
; 298  : 	va_start(ap, pFormat);
; 299  : 	RPC_BINDING_HANDLE Binding = (RPC_BINDING_HANDLE)va_arg(ap, PVOID);
; 300  : 	int requestSize = (int)va_arg(ap, int);
; 301  : 	BYTE *requestData = (BYTE *)va_arg(ap, PVOID);
; 302  : 	int *responseSize = (int *)va_arg(ap, PVOID);
; 303  : 	BYTE **responseData = (BYTE **)va_arg(ap, PVOID);
; 304  : 	va_end(ap);
; 305  : #else
; 306  : 	DWORD* funcVarList = *(DWORD**)(((BYTE*)&pFormat) + sizeof(const unsigned char*));

  00040	8b 45 10	 mov	 eax, DWORD PTR _pFormat$[ebp+4]
  00043	89 85 fc fb ff
	ff		 mov	 DWORD PTR _funcVarList$[ebp], eax

; 307  : 	RPC_BINDING_HANDLE Binding = (RPC_BINDING_HANDLE)(funcVarList[0]);

  00049	b8 04 00 00 00	 mov	 eax, 4
  0004e	6b c8 00	 imul	 ecx, eax, 0
  00051	8b 95 fc fb ff
	ff		 mov	 edx, DWORD PTR _funcVarList$[ebp]
  00057	8b 04 0a	 mov	 eax, DWORD PTR [edx+ecx]
  0005a	89 85 f8 fb ff
	ff		 mov	 DWORD PTR _Binding$[ebp], eax

; 308  : 	int requestSize = (int)(funcVarList[1]);

  00060	b8 04 00 00 00	 mov	 eax, 4
  00065	c1 e0 00	 shl	 eax, 0
  00068	8b 8d fc fb ff
	ff		 mov	 ecx, DWORD PTR _funcVarList$[ebp]
  0006e	8b 14 01	 mov	 edx, DWORD PTR [ecx+eax]
  00071	89 95 f4 fb ff
	ff		 mov	 DWORD PTR _requestSize$[ebp], edx

; 309  : 	BYTE* requestData = (BYTE*)(funcVarList[2]);

  00077	b8 04 00 00 00	 mov	 eax, 4
  0007c	d1 e0		 shl	 eax, 1
  0007e	8b 8d fc fb ff
	ff		 mov	 ecx, DWORD PTR _funcVarList$[ebp]
  00084	8b 14 01	 mov	 edx, DWORD PTR [ecx+eax]
  00087	89 95 f0 fb ff
	ff		 mov	 DWORD PTR _requestData$[ebp], edx

; 310  : 	int* responseSize = (int*)(funcVarList[3]);

  0008d	b8 04 00 00 00	 mov	 eax, 4
  00092	6b c8 03	 imul	 ecx, eax, 3
  00095	8b 95 fc fb ff
	ff		 mov	 edx, DWORD PTR _funcVarList$[ebp]
  0009b	8b 04 0a	 mov	 eax, DWORD PTR [edx+ecx]
  0009e	89 85 ec fb ff
	ff		 mov	 DWORD PTR _responseSize$[ebp], eax

; 311  : 	BYTE** responseData = (BYTE**)(funcVarList[4]);

  000a4	b8 04 00 00 00	 mov	 eax, 4
  000a9	c1 e0 02	 shl	 eax, 2
  000ac	8b 8d fc fb ff
	ff		 mov	 ecx, DWORD PTR _funcVarList$[ebp]
  000b2	8b 14 01	 mov	 edx, DWORD PTR [ecx+eax]
  000b5	89 95 e8 fb ff
	ff		 mov	 DWORD PTR _responseData$[ebp], edx

; 312  : #endif
; 313  : 
; 314  : 	OutputDebugStringEx(L"[SppExtComObjHook] pStubDescriptor = 0x%p, pFormat = 0x%p, Binding = 0x%p, requestSize = %d, resuestData = 0x%p, responseSize = 0x%p, responseData = 0x%p\n",

  000bb	8b 85 e8 fb ff
	ff		 mov	 eax, DWORD PTR _responseData$[ebp]
  000c1	50		 push	 eax
  000c2	8b 8d ec fb ff
	ff		 mov	 ecx, DWORD PTR _responseSize$[ebp]
  000c8	51		 push	 ecx
  000c9	8b 95 f0 fb ff
	ff		 mov	 edx, DWORD PTR _requestData$[ebp]
  000cf	52		 push	 edx
  000d0	8b 85 f4 fb ff
	ff		 mov	 eax, DWORD PTR _requestSize$[ebp]
  000d6	50		 push	 eax
  000d7	8b 8d f8 fb ff
	ff		 mov	 ecx, DWORD PTR _Binding$[ebp]
  000dd	51		 push	 ecx
  000de	8b 55 0c	 mov	 edx, DWORD PTR _pFormat$[ebp]
  000e1	52		 push	 edx
  000e2	8b 45 08	 mov	 eax, DWORD PTR _pStubDescriptor$[ebp]
  000e5	50		 push	 eax
  000e6	68 00 00 00 00	 push	 OFFSET ??_C@_1BDG@BEEGGHPN@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  000eb	68 00 02 00 00	 push	 512			; 00000200H
  000f0	8d 8d e8 f7 ff
	ff		 lea	 ecx, DWORD PTR _c$6[ebp]
  000f6	51		 push	 ecx
  000f7	e8 00 00 00 00	 call	 _swprintf_s
  000fc	83 c4 28	 add	 esp, 40			; 00000028H
  000ff	8d 85 e8 f7 ff
	ff		 lea	 eax, DWORD PTR _c$6[ebp]
  00105	50		 push	 eax
  00106	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 315  : 		pStubDescriptor, pFormat, Binding, requestSize, requestData, responseSize, responseData);
; 316  : 
; 317  : 	if (newRpcConnection.Initialized && pStubDescriptor != nullptr && pFormat != nullptr)

  0010c	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0
  00113	0f 84 e7 00 00
	00		 je	 $LN2@NdrClientC
  00119	83 7d 08 00	 cmp	 DWORD PTR _pStubDescriptor$[ebp], 0
  0011d	0f 84 dd 00 00
	00		 je	 $LN2@NdrClientC
  00123	83 7d 0c 00	 cmp	 DWORD PTR _pFormat$[ebp], 0
  00127	0f 84 d3 00 00
	00		 je	 $LN2@NdrClientC

; 318  : 	{
; 319  : 		if (newRpcConnection.hRpcBinding == Binding)

  0012d	a1 04 01 00 00	 mov	 eax, DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+260
  00132	3b 85 f8 fb ff
	ff		 cmp	 eax, DWORD PTR _Binding$[ebp]
  00138	0f 85 c2 00 00
	00		 jne	 $LN2@NdrClientC

; 320  : 		{
; 321  : 			if (newRpcConnection.hThread == GetCurrentThread())

  0013e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetCurrentThread@0
  00144	39 05 0c 01 00
	00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+268, eax
  0014a	0f 85 b0 00 00
	00		 jne	 $LN2@NdrClientC

; 322  : 			{
; 323  : 				ReadRegistrySettings();

  00150	e8 00 00 00 00	 call	 ?ReadRegistrySettings@@YGKXZ ; ReadRegistrySettings

; 324  : 
; 325  : 				OutputDebugStringEx(L"[SppExtComObjHook] Emulating Server... Writing Response!\n");

  00155	68 00 00 00 00	 push	 OFFSET ??_C@_1HE@KAFLNIFK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  0015a	68 00 02 00 00	 push	 512			; 00000200H
  0015f	8d 85 e8 f3 ff
	ff		 lea	 eax, DWORD PTR _c$5[ebp]
  00165	50		 push	 eax
  00166	e8 00 00 00 00	 call	 _swprintf_s
  0016b	83 c4 0c	 add	 esp, 12			; 0000000cH
  0016e	8d 85 e8 f3 ff
	ff		 lea	 eax, DWORD PTR _c$5[ebp]
  00174	50		 push	 eax
  00175	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 326  : 
; 327  : 				if (ActivationResponse(requestSize, requestData, responseSize, responseData) == RPC_S_OK)

  0017b	8b 85 e8 fb ff
	ff		 mov	 eax, DWORD PTR _responseData$[ebp]
  00181	50		 push	 eax
  00182	8b 8d ec fb ff
	ff		 mov	 ecx, DWORD PTR _responseSize$[ebp]
  00188	51		 push	 ecx
  00189	8b 95 f0 fb ff
	ff		 mov	 edx, DWORD PTR _requestData$[ebp]
  0018f	52		 push	 edx
  00190	8b 85 f4 fb ff
	ff		 mov	 eax, DWORD PTR _requestSize$[ebp]
  00196	50		 push	 eax
  00197	e8 00 00 00 00	 call	 ?ActivationResponse@@YGHHPAEPAHPAPAE@Z ; ActivationResponse
  0019c	85 c0		 test	 eax, eax
  0019e	75 28		 jne	 SHORT $LN5@NdrClientC

; 328  : 				{
; 329  : 					OutputDebugStringEx(L"[SppExtComObjHook] Emulating Server... Activation Success!\n");

  001a0	68 00 00 00 00	 push	 OFFSET ??_C@_1HI@HFEFOPKC@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  001a5	68 00 02 00 00	 push	 512			; 00000200H
  001aa	8d 85 e8 ef ff
	ff		 lea	 eax, DWORD PTR _c$4[ebp]
  001b0	50		 push	 eax
  001b1	e8 00 00 00 00	 call	 _swprintf_s
  001b6	83 c4 0c	 add	 esp, 12			; 0000000cH
  001b9	8d 85 e8 ef ff
	ff		 lea	 eax, DWORD PTR _c$4[ebp]
  001bf	50		 push	 eax
  001c0	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 330  : 				}

  001c6	eb 26		 jmp	 SHORT $LN6@NdrClientC
$LN5@NdrClientC:

; 331  : 				else
; 332  : 				{
; 333  : 					OutputDebugStringEx(L"[SppExtComObjHook] Emulating Server... Activation Failed!\n");

  001c8	68 00 00 00 00	 push	 OFFSET ??_C@_1HG@MBEKBOEL@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  001cd	68 00 02 00 00	 push	 512			; 00000200H
  001d2	8d 85 e8 eb ff
	ff		 lea	 eax, DWORD PTR _c$3[ebp]
  001d8	50		 push	 eax
  001d9	e8 00 00 00 00	 call	 _swprintf_s
  001de	83 c4 0c	 add	 esp, 12			; 0000000cH
  001e1	8d 85 e8 eb ff
	ff		 lea	 eax, DWORD PTR _c$3[ebp]
  001e7	50		 push	 eax
  001e8	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4
$LN6@NdrClientC:

; 334  : 				}
; 335  : 
; 336  : 				CLIENT_CALL_RETURN ret = { 0 };

  001ee	c7 85 e4 eb ff
	ff 00 00 00 00	 mov	 DWORD PTR _ret$2[ebp], 0

; 337  : 
; 338  : 				return ret;

  001f8	8b 85 e4 eb ff
	ff		 mov	 eax, DWORD PTR _ret$2[ebp]
  001fe	eb 2e		 jmp	 SHORT $LN1@NdrClientC
$LN2@NdrClientC:

; 339  : 			}
; 340  : 		}
; 341  : 	}
; 342  : 
; 343  : #ifdef _WIN64
; 344  : 	return CALL_ORIGINAL_FUNC(NdrClientCall2, pStubDescriptor, pFormat, Binding, requestSize, requestData, responseSize, responseData);
; 345  : #else
; 346  : 	return CALL_ORIGINAL_FUNC(NdrClientCall2, pStubDescriptor, pFormat, funcVarList);

  00200	8b 85 fc fb ff
	ff		 mov	 eax, DWORD PTR _funcVarList$[ebp]
  00206	50		 push	 eax
  00207	8b 4d 0c	 mov	 ecx, DWORD PTR _pFormat$[ebp]
  0020a	51		 push	 ecx
  0020b	8b 55 08	 mov	 edx, DWORD PTR _pStubDescriptor$[ebp]
  0020e	52		 push	 edx
  0020f	b8 10 00 00 00	 mov	 eax, 16			; 00000010H
  00214	c1 e0 03	 shl	 eax, 3
  00217	8b 88 0c 00 00
	00		 mov	 ecx, DWORD PTR ?APIHooks@@3PAU_APIHook@@A[eax+12]
  0021d	ff d1		 call	 ecx
  0021f	83 c4 0c	 add	 esp, 12			; 0000000cH
  00222	89 85 e0 e9 ff
	ff		 mov	 DWORD PTR $T1[ebp], eax
  00228	8b 85 e0 e9 ff
	ff		 mov	 eax, DWORD PTR $T1[ebp]
$LN1@NdrClientC:

; 347  : #endif
; 348  : }

  0022e	5f		 pop	 edi
  0022f	5e		 pop	 esi
  00230	5b		 pop	 ebx
  00231	8b e5		 mov	 esp, ebp
  00233	5d		 pop	 ebp
  00234	c3		 ret	 0
?NdrClientCall2_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ ENDP ; NdrClientCall2_Hook
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?NdrAsyncClientCall_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ
_TEXT	SEGMENT
$T1 = -5668						; size = 4
_ret$2 = -5152						; size = 4
_c$3 = -5148						; size = 1024
_c$4 = -4124						; size = 1024
_c$5 = -3100						; size = 1024
_c$6 = -2076						; size = 1024
_responseData$ = -1052					; size = 4
_responseSize$ = -1048					; size = 4
_requestData$ = -1044					; size = 4
_requestSize$ = -1040					; size = 4
_Binding$ = -1036					; size = 4
_pAsync$ = -1032					; size = 4
_funcVarList$ = -1028					; size = 4
_c$7 = -1024						; size = 1024
_pStubDescriptor$ = 8					; size = 4
_pFormat$ = 12						; size = 4
?NdrAsyncClientCall_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ PROC ; NdrAsyncClientCall_Hook, COMDAT

; 228  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	b8 24 16 00 00	 mov	 eax, 5668		; 00001624H
  00008	e8 00 00 00 00	 call	 __chkstk
  0000d	53		 push	 ebx
  0000e	56		 push	 esi
  0000f	57		 push	 edi
  00010	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00015	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 229  : 	OutputDebugStringEx(L"[SppExtComObjHook] NdrAsyncClientCall called\n");

  0001a	68 00 00 00 00	 push	 OFFSET ??_C@_1FM@FFJCOKGI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  0001f	68 00 02 00 00	 push	 512			; 00000200H
  00024	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$7[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 _swprintf_s
  00030	83 c4 0c	 add	 esp, 12			; 0000000cH
  00033	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$7[ebp]
  00039	50		 push	 eax
  0003a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 230  : 
; 231  : #ifdef _WIN64
; 232  : 	va_list ap = nullptr;
; 233  : 	va_start(ap, pFormat);
; 234  : 	PRPC_ASYNC_STATE pAsync = (PRPC_ASYNC_STATE)va_arg(ap, PVOID);
; 235  : 	RPC_BINDING_HANDLE Binding = (RPC_BINDING_HANDLE)va_arg(ap, PVOID);
; 236  : 	int requestSize = (int)va_arg(ap, int);
; 237  : 	BYTE *requestData = (BYTE *)va_arg(ap, PVOID);
; 238  : 	int *responseSize = (int *)va_arg(ap, PVOID);
; 239  : 	BYTE **responseData = (BYTE **)va_arg(ap, PVOID);
; 240  : 	va_end(ap);
; 241  : #else
; 242  : 	DWORD* funcVarList = *(DWORD**)(((BYTE*)&pFormat) + sizeof(const unsigned char*));

  00040	8b 45 10	 mov	 eax, DWORD PTR _pFormat$[ebp+4]
  00043	89 85 fc fb ff
	ff		 mov	 DWORD PTR _funcVarList$[ebp], eax

; 243  : 	PRPC_ASYNC_STATE pAsync = (PRPC_ASYNC_STATE)(funcVarList[0]);

  00049	b8 04 00 00 00	 mov	 eax, 4
  0004e	6b c8 00	 imul	 ecx, eax, 0
  00051	8b 95 fc fb ff
	ff		 mov	 edx, DWORD PTR _funcVarList$[ebp]
  00057	8b 04 0a	 mov	 eax, DWORD PTR [edx+ecx]
  0005a	89 85 f8 fb ff
	ff		 mov	 DWORD PTR _pAsync$[ebp], eax

; 244  : 	RPC_BINDING_HANDLE Binding = (RPC_BINDING_HANDLE)(funcVarList[1]);

  00060	b8 04 00 00 00	 mov	 eax, 4
  00065	c1 e0 00	 shl	 eax, 0
  00068	8b 8d fc fb ff
	ff		 mov	 ecx, DWORD PTR _funcVarList$[ebp]
  0006e	8b 14 01	 mov	 edx, DWORD PTR [ecx+eax]
  00071	89 95 f4 fb ff
	ff		 mov	 DWORD PTR _Binding$[ebp], edx

; 245  : 	int requestSize = (int)(funcVarList[2]);

  00077	b8 04 00 00 00	 mov	 eax, 4
  0007c	d1 e0		 shl	 eax, 1
  0007e	8b 8d fc fb ff
	ff		 mov	 ecx, DWORD PTR _funcVarList$[ebp]
  00084	8b 14 01	 mov	 edx, DWORD PTR [ecx+eax]
  00087	89 95 f0 fb ff
	ff		 mov	 DWORD PTR _requestSize$[ebp], edx

; 246  : 	BYTE* requestData = (BYTE*)(funcVarList[3]);

  0008d	b8 04 00 00 00	 mov	 eax, 4
  00092	6b c8 03	 imul	 ecx, eax, 3
  00095	8b 95 fc fb ff
	ff		 mov	 edx, DWORD PTR _funcVarList$[ebp]
  0009b	8b 04 0a	 mov	 eax, DWORD PTR [edx+ecx]
  0009e	89 85 ec fb ff
	ff		 mov	 DWORD PTR _requestData$[ebp], eax

; 247  : 	int* responseSize = (int*)(funcVarList[4]);

  000a4	b8 04 00 00 00	 mov	 eax, 4
  000a9	c1 e0 02	 shl	 eax, 2
  000ac	8b 8d fc fb ff
	ff		 mov	 ecx, DWORD PTR _funcVarList$[ebp]
  000b2	8b 14 01	 mov	 edx, DWORD PTR [ecx+eax]
  000b5	89 95 e8 fb ff
	ff		 mov	 DWORD PTR _responseSize$[ebp], edx

; 248  : 	BYTE** responseData = (BYTE**)(funcVarList[5]);

  000bb	b8 04 00 00 00	 mov	 eax, 4
  000c0	6b c8 05	 imul	 ecx, eax, 5
  000c3	8b 95 fc fb ff
	ff		 mov	 edx, DWORD PTR _funcVarList$[ebp]
  000c9	8b 04 0a	 mov	 eax, DWORD PTR [edx+ecx]
  000cc	89 85 e4 fb ff
	ff		 mov	 DWORD PTR _responseData$[ebp], eax

; 249  : #endif
; 250  : 
; 251  : 	OutputDebugStringEx(L"[SppExtComObjHook] pStubDescriptor = 0x%p, pFormat = 0x%p, pAsync = 0x%p, Binding = 0x%p, requestSize = %d, resuestData = 0x%p, responseSize = 0x%p, responseData = 0x%p\n",

  000d2	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _responseData$[ebp]
  000d8	50		 push	 eax
  000d9	8b 8d e8 fb ff
	ff		 mov	 ecx, DWORD PTR _responseSize$[ebp]
  000df	51		 push	 ecx
  000e0	8b 95 ec fb ff
	ff		 mov	 edx, DWORD PTR _requestData$[ebp]
  000e6	52		 push	 edx
  000e7	8b 85 f0 fb ff
	ff		 mov	 eax, DWORD PTR _requestSize$[ebp]
  000ed	50		 push	 eax
  000ee	8b 8d f4 fb ff
	ff		 mov	 ecx, DWORD PTR _Binding$[ebp]
  000f4	51		 push	 ecx
  000f5	8b 95 f8 fb ff
	ff		 mov	 edx, DWORD PTR _pAsync$[ebp]
  000fb	52		 push	 edx
  000fc	8b 45 0c	 mov	 eax, DWORD PTR _pFormat$[ebp]
  000ff	50		 push	 eax
  00100	8b 4d 08	 mov	 ecx, DWORD PTR _pStubDescriptor$[ebp]
  00103	51		 push	 ecx
  00104	68 00 00 00 00	 push	 OFFSET ??_C@_1BFE@HBFGDEEA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  00109	68 00 02 00 00	 push	 512			; 00000200H
  0010e	8d 95 e4 f7 ff
	ff		 lea	 edx, DWORD PTR _c$6[ebp]
  00114	52		 push	 edx
  00115	e8 00 00 00 00	 call	 _swprintf_s
  0011a	83 c4 2c	 add	 esp, 44			; 0000002cH
  0011d	8d 85 e4 f7 ff
	ff		 lea	 eax, DWORD PTR _c$6[ebp]
  00123	50		 push	 eax
  00124	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 252  : 		pStubDescriptor, pFormat, pAsync, Binding, requestSize, requestData, responseSize, responseData);
; 253  : 
; 254  : 	if (newRpcConnection.Initialized && pStubDescriptor != nullptr && pFormat != nullptr)

  0012a	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0
  00131	0f 84 28 01 00
	00		 je	 $LN2@NdrAsyncCl
  00137	83 7d 08 00	 cmp	 DWORD PTR _pStubDescriptor$[ebp], 0
  0013b	0f 84 1e 01 00
	00		 je	 $LN2@NdrAsyncCl
  00141	83 7d 0c 00	 cmp	 DWORD PTR _pFormat$[ebp], 0
  00145	0f 84 14 01 00
	00		 je	 $LN2@NdrAsyncCl

; 255  : 	{
; 256  : 		if (newRpcConnection.hRpcBinding == Binding && newRpcConnection.pAsync == pAsync)

  0014b	a1 04 01 00 00	 mov	 eax, DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+260
  00150	3b 85 f4 fb ff
	ff		 cmp	 eax, DWORD PTR _Binding$[ebp]
  00156	0f 85 03 01 00
	00		 jne	 $LN2@NdrAsyncCl
  0015c	a1 08 01 00 00	 mov	 eax, DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+264
  00161	3b 85 f8 fb ff
	ff		 cmp	 eax, DWORD PTR _pAsync$[ebp]
  00167	0f 85 f2 00 00
	00		 jne	 $LN2@NdrAsyncCl

; 257  : 		{
; 258  : 			if (newRpcConnection.hThread == GetCurrentThread())

  0016d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetCurrentThread@0
  00173	39 05 0c 01 00
	00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+268, eax
  00179	0f 85 e0 00 00
	00		 jne	 $LN2@NdrAsyncCl

; 259  : 			{
; 260  : 				if (pAsync->u.APC.NotificationRoutine != nullptr && pAsync->u.APC.NotificationRoutine != INVALID_HANDLE_VALUE)

  0017f	8b 85 f8 fb ff
	ff		 mov	 eax, DWORD PTR _pAsync$[ebp]
  00185	83 78 24 00	 cmp	 DWORD PTR [eax+36], 0
  00189	0f 84 d0 00 00
	00		 je	 $LN2@NdrAsyncCl
  0018f	8b 85 f8 fb ff
	ff		 mov	 eax, DWORD PTR _pAsync$[ebp]
  00195	83 78 24 ff	 cmp	 DWORD PTR [eax+36], -1
  00199	0f 84 c0 00 00
	00		 je	 $LN2@NdrAsyncCl

; 261  : 				{
; 262  : 					ReadRegistrySettings();

  0019f	e8 00 00 00 00	 call	 ?ReadRegistrySettings@@YGKXZ ; ReadRegistrySettings

; 263  : 
; 264  : 					OutputDebugStringEx(L"[SppExtComObjHook] Emulating Server... Writing Response!\n");

  001a4	68 00 00 00 00	 push	 OFFSET ??_C@_1HE@KAFLNIFK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  001a9	68 00 02 00 00	 push	 512			; 00000200H
  001ae	8d 85 e4 f3 ff
	ff		 lea	 eax, DWORD PTR _c$5[ebp]
  001b4	50		 push	 eax
  001b5	e8 00 00 00 00	 call	 _swprintf_s
  001ba	83 c4 0c	 add	 esp, 12			; 0000000cH
  001bd	8d 85 e4 f3 ff
	ff		 lea	 eax, DWORD PTR _c$5[ebp]
  001c3	50		 push	 eax
  001c4	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 265  : 
; 266  : 					if (ActivationResponse(requestSize, requestData, responseSize, responseData) == RPC_S_OK)

  001ca	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _responseData$[ebp]
  001d0	50		 push	 eax
  001d1	8b 8d e8 fb ff
	ff		 mov	 ecx, DWORD PTR _responseSize$[ebp]
  001d7	51		 push	 ecx
  001d8	8b 95 ec fb ff
	ff		 mov	 edx, DWORD PTR _requestData$[ebp]
  001de	52		 push	 edx
  001df	8b 85 f0 fb ff
	ff		 mov	 eax, DWORD PTR _requestSize$[ebp]
  001e5	50		 push	 eax
  001e6	e8 00 00 00 00	 call	 ?ActivationResponse@@YGHHPAEPAHPAPAE@Z ; ActivationResponse
  001eb	85 c0		 test	 eax, eax
  001ed	75 28		 jne	 SHORT $LN6@NdrAsyncCl

; 267  : 					{
; 268  : 						OutputDebugStringEx(L"[SppExtComObjHook] Emulating Server... Activation Success!\n");

  001ef	68 00 00 00 00	 push	 OFFSET ??_C@_1HI@HFEFOPKC@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  001f4	68 00 02 00 00	 push	 512			; 00000200H
  001f9	8d 85 e4 ef ff
	ff		 lea	 eax, DWORD PTR _c$4[ebp]
  001ff	50		 push	 eax
  00200	e8 00 00 00 00	 call	 _swprintf_s
  00205	83 c4 0c	 add	 esp, 12			; 0000000cH
  00208	8d 85 e4 ef ff
	ff		 lea	 eax, DWORD PTR _c$4[ebp]
  0020e	50		 push	 eax
  0020f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 269  : 					}

  00215	eb 26		 jmp	 SHORT $LN7@NdrAsyncCl
$LN6@NdrAsyncCl:

; 270  : 					else
; 271  : 					{
; 272  : 						OutputDebugStringEx(L"[SppExtComObjHook] Emulating Server... Activation Failed!\n");

  00217	68 00 00 00 00	 push	 OFFSET ??_C@_1HG@MBEKBOEL@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  0021c	68 00 02 00 00	 push	 512			; 00000200H
  00221	8d 85 e4 eb ff
	ff		 lea	 eax, DWORD PTR _c$3[ebp]
  00227	50		 push	 eax
  00228	e8 00 00 00 00	 call	 _swprintf_s
  0022d	83 c4 0c	 add	 esp, 12			; 0000000cH
  00230	8d 85 e4 eb ff
	ff		 lea	 eax, DWORD PTR _c$3[ebp]
  00236	50		 push	 eax
  00237	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4
$LN7@NdrAsyncCl:

; 273  : 					}
; 274  : 
; 275  : 					SetEvent(pAsync->u.APC.NotificationRoutine);

  0023d	8b 85 f8 fb ff
	ff		 mov	 eax, DWORD PTR _pAsync$[ebp]
  00243	8b 48 24	 mov	 ecx, DWORD PTR [eax+36]
  00246	51		 push	 ecx
  00247	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetEvent@4

; 276  : 
; 277  : 					CLIENT_CALL_RETURN ret = { 0 };

  0024d	c7 85 e0 eb ff
	ff 00 00 00 00	 mov	 DWORD PTR _ret$2[ebp], 0

; 278  : 
; 279  : 					return ret;

  00257	8b 85 e0 eb ff
	ff		 mov	 eax, DWORD PTR _ret$2[ebp]
  0025d	eb 2e		 jmp	 SHORT $LN1@NdrAsyncCl
$LN2@NdrAsyncCl:

; 280  : 				}
; 281  : 			}
; 282  : 		}
; 283  : 	}
; 284  : 
; 285  : #ifdef _WIN64
; 286  : 	return CALL_ORIGINAL_FUNC(NdrAsyncClientCall, pStubDescriptor, pFormat, pAsync, Binding, requestSize, requestData, responseSize, responseData);
; 287  : #else
; 288  : 	return CALL_ORIGINAL_FUNC(NdrAsyncClientCall, pStubDescriptor, pFormat, funcVarList);

  0025f	8b 85 fc fb ff
	ff		 mov	 eax, DWORD PTR _funcVarList$[ebp]
  00265	50		 push	 eax
  00266	8b 4d 0c	 mov	 ecx, DWORD PTR _pFormat$[ebp]
  00269	51		 push	 ecx
  0026a	8b 55 08	 mov	 edx, DWORD PTR _pStubDescriptor$[ebp]
  0026d	52		 push	 edx
  0026e	b8 10 00 00 00	 mov	 eax, 16			; 00000010H
  00273	6b c8 07	 imul	 ecx, eax, 7
  00276	8b 91 0c 00 00
	00		 mov	 edx, DWORD PTR ?APIHooks@@3PAU_APIHook@@A[ecx+12]
  0027c	ff d2		 call	 edx
  0027e	83 c4 0c	 add	 esp, 12			; 0000000cH
  00281	89 85 dc e9 ff
	ff		 mov	 DWORD PTR $T1[ebp], eax
  00287	8b 85 dc e9 ff
	ff		 mov	 eax, DWORD PTR $T1[ebp]
$LN1@NdrAsyncCl:

; 289  : #endif
; 290  : }

  0028d	5f		 pop	 edi
  0028e	5e		 pop	 esi
  0028f	5b		 pop	 ebx
  00290	8b e5		 mov	 esp, ebp
  00292	5d		 pop	 ebp
  00293	c3		 ret	 0
?NdrAsyncClientCall_Hook@@YA?AT_CLIENT_CALL_RETURN@@PBU_MIDL_STUB_DESC@@PBEZZ ENDP ; NdrAsyncClientCall_Hook
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?RpcAsyncCompleteCall_Hook@@YGJPAU_RPC_ASYNC_STATE@@PAX@Z
_TEXT	SEGMENT
_c$1 = -1024						; size = 1024
_pAsync$ = 8						; size = 4
_Reply$ = 12						; size = 4
?RpcAsyncCompleteCall_Hook@@YGJPAU_RPC_ASYNC_STATE@@PAX@Z PROC ; RpcAsyncCompleteCall_Hook, COMDAT

; 210  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c0 04 00
	00		 sub	 esp, 1216		; 000004c0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00011	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 211  : 	if (pAsync != nullptr && Reply != nullptr)

  00016	83 7d 08 00	 cmp	 DWORD PTR _pAsync$[ebp], 0
  0001a	74 64		 je	 SHORT $LN2@RpcAsyncCo
  0001c	83 7d 0c 00	 cmp	 DWORD PTR _Reply$[ebp], 0
  00020	74 5e		 je	 SHORT $LN2@RpcAsyncCo

; 212  : 	{
; 213  : 		if (newRpcConnection.Initialized && newRpcConnection.pAsync != nullptr && newRpcConnection.hRpcBinding != nullptr)

  00022	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0
  00029	74 55		 je	 SHORT $LN2@RpcAsyncCo
  0002b	83 3d 08 01 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+264, 0
  00032	74 4c		 je	 SHORT $LN2@RpcAsyncCo
  00034	83 3d 04 01 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+260, 0
  0003b	74 43		 je	 SHORT $LN2@RpcAsyncCo

; 214  : 		{
; 215  : 			if (newRpcConnection.hThread == GetCurrentThread() && pAsync == newRpcConnection.pAsync)

  0003d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetCurrentThread@0
  00043	39 05 0c 01 00
	00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+268, eax
  00049	75 35		 jne	 SHORT $LN2@RpcAsyncCo
  0004b	8b 45 08	 mov	 eax, DWORD PTR _pAsync$[ebp]
  0004e	3b 05 08 01 00
	00		 cmp	 eax, DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+264
  00054	75 2a		 jne	 SHORT $LN2@RpcAsyncCo

; 216  : 			{
; 217  : 				OutputDebugStringEx(L"[SppExtComObjHook] Emulating Server... Return RPC_S_OK...\n");

  00056	68 00 00 00 00	 push	 OFFSET ??_C@_1HG@EPAGGJO@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  0005b	68 00 02 00 00	 push	 512			; 00000200H
  00060	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  00066	50		 push	 eax
  00067	e8 00 00 00 00	 call	 _swprintf_s
  0006c	83 c4 0c	 add	 esp, 12			; 0000000cH
  0006f	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  00075	50		 push	 eax
  00076	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 218  : 
; 219  : 				return RPC_S_OK;

  0007c	33 c0		 xor	 eax, eax
  0007e	eb 18		 jmp	 SHORT $LN1@RpcAsyncCo
$LN2@RpcAsyncCo:

; 220  : 			}
; 221  : 		}
; 222  : 	}
; 223  : 
; 224  : 	return CALL_ORIGINAL_FUNC(RpcAsyncCompleteCall, pAsync, Reply);

  00080	8b 45 0c	 mov	 eax, DWORD PTR _Reply$[ebp]
  00083	50		 push	 eax
  00084	8b 4d 08	 mov	 ecx, DWORD PTR _pAsync$[ebp]
  00087	51		 push	 ecx
  00088	ba 10 00 00 00	 mov	 edx, 16			; 00000010H
  0008d	6b c2 06	 imul	 eax, edx, 6
  00090	8b 88 0c 00 00
	00		 mov	 ecx, DWORD PTR ?APIHooks@@3PAU_APIHook@@A[eax+12]
  00096	ff d1		 call	 ecx
$LN1@RpcAsyncCo:

; 225  : }

  00098	5f		 pop	 edi
  00099	5e		 pop	 esi
  0009a	5b		 pop	 ebx
  0009b	8b e5		 mov	 esp, ebp
  0009d	5d		 pop	 ebp
  0009e	c2 08 00	 ret	 8
?RpcAsyncCompleteCall_Hook@@YGJPAU_RPC_ASYNC_STATE@@PAX@Z ENDP ; RpcAsyncCompleteCall_Hook
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?RpcAsyncInitializeHandle_Hook@@YGJPAU_RPC_ASYNC_STATE@@I@Z
_TEXT	SEGMENT
_c$1 = -1028						; size = 1024
_status$ = -4						; size = 4
_pAsync$ = 8						; size = 4
_Size$ = 12						; size = 4
?RpcAsyncInitializeHandle_Hook@@YGJPAU_RPC_ASYNC_STATE@@I@Z PROC ; RpcAsyncInitializeHandle_Hook, COMDAT

; 191  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c4 04 00
	00		 sub	 esp, 1220		; 000004c4H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00011	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 192  : 	RPC_STATUS status = CALL_ORIGINAL_FUNC(RpcAsyncInitializeHandle, pAsync, Size);

  00016	8b 45 0c	 mov	 eax, DWORD PTR _Size$[ebp]
  00019	50		 push	 eax
  0001a	8b 4d 08	 mov	 ecx, DWORD PTR _pAsync$[ebp]
  0001d	51		 push	 ecx
  0001e	ba 10 00 00 00	 mov	 edx, 16			; 00000010H
  00023	6b c2 05	 imul	 eax, edx, 5
  00026	8b 88 0c 00 00
	00		 mov	 ecx, DWORD PTR ?APIHooks@@3PAU_APIHook@@A[eax+12]
  0002c	ff d1		 call	 ecx
  0002e	89 45 fc	 mov	 DWORD PTR _status$[ebp], eax

; 193  : 
; 194  : 	if (status != RPC_S_OK)

  00031	83 7d fc 00	 cmp	 DWORD PTR _status$[ebp], 0
  00035	74 05		 je	 SHORT $LN2@RpcAsyncIn

; 195  : 		return status;

  00037	8b 45 fc	 mov	 eax, DWORD PTR _status$[ebp]
  0003a	eb 5a		 jmp	 SHORT $LN1@RpcAsyncIn
$LN2@RpcAsyncIn:

; 196  : 
; 197  : 	if (newRpcConnection.Initialized && newRpcConnection.hRpcBinding != nullptr && newRpcConnection.pAsync == nullptr)

  0003c	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0
  00043	74 4e		 je	 SHORT $LN3@RpcAsyncIn
  00045	83 3d 04 01 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+260, 0
  0004c	74 45		 je	 SHORT $LN3@RpcAsyncIn
  0004e	83 3d 08 01 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+264, 0
  00055	75 3c		 jne	 SHORT $LN3@RpcAsyncIn

; 198  : 	{
; 199  : 		if (newRpcConnection.hThread == GetCurrentThread())

  00057	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetCurrentThread@0
  0005d	39 05 0c 01 00
	00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+268, eax
  00063	75 2e		 jne	 SHORT $LN3@RpcAsyncIn

; 200  : 		{
; 201  : 			OutputDebugStringEx(L"[SppExtComObjHook] Emulating Server... Saved Async Handle\n");

  00065	68 00 00 00 00	 push	 OFFSET ??_C@_1HG@CMDJOPCN@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  0006a	68 00 02 00 00	 push	 512			; 00000200H
  0006f	8d 85 fc fb ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  00075	50		 push	 eax
  00076	e8 00 00 00 00	 call	 _swprintf_s
  0007b	83 c4 0c	 add	 esp, 12			; 0000000cH
  0007e	8d 85 fc fb ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  00084	50		 push	 eax
  00085	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 202  : 			newRpcConnection.pAsync = pAsync;

  0008b	8b 45 08	 mov	 eax, DWORD PTR _pAsync$[ebp]
  0008e	a3 08 01 00 00	 mov	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+264, eax
$LN3@RpcAsyncIn:

; 203  : 		}
; 204  : 	}
; 205  : 
; 206  : 	return status;

  00093	8b 45 fc	 mov	 eax, DWORD PTR _status$[ebp]
$LN1@RpcAsyncIn:

; 207  : }

  00096	5f		 pop	 edi
  00097	5e		 pop	 esi
  00098	5b		 pop	 ebx
  00099	8b e5		 mov	 esp, ebp
  0009b	5d		 pop	 ebp
  0009c	c2 08 00	 ret	 8
?RpcAsyncInitializeHandle_Hook@@YGJPAU_RPC_ASYNC_STATE@@I@Z ENDP ; RpcAsyncInitializeHandle_Hook
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?RpcBindingFree_Hook@@YGJPAPAX@Z
_TEXT	SEGMENT
_c$1 = -1024						; size = 1024
_Binding$ = 8						; size = 4
?RpcBindingFree_Hook@@YGJPAPAX@Z PROC			; RpcBindingFree_Hook, COMDAT

; 171  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c0 04 00
	00		 sub	 esp, 1216		; 000004c0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00011	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 172  : 	if (newRpcConnection.Initialized && Binding != nullptr)

  00016	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0
  0001d	74 73		 je	 SHORT $LN2@RpcBinding
  0001f	83 7d 08 00	 cmp	 DWORD PTR _Binding$[ebp], 0
  00023	74 6d		 je	 SHORT $LN2@RpcBinding

; 173  : 	{
; 174  : 		if (*Binding == newRpcConnection.hRpcBinding && newRpcConnection.hThread == GetCurrentThread())

  00025	8b 45 08	 mov	 eax, DWORD PTR _Binding$[ebp]
  00028	8b 08		 mov	 ecx, DWORD PTR [eax]
  0002a	3b 0d 04 01 00
	00		 cmp	 ecx, DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+260
  00030	75 60		 jne	 SHORT $LN2@RpcBinding
  00032	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetCurrentThread@0
  00038	39 05 0c 01 00
	00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+268, eax
  0003e	75 52		 jne	 SHORT $LN2@RpcBinding

; 175  : 		{
; 176  : 			OutputDebugStringEx(L"[SppExtComObjHook] Free Connection...\n");

  00040	68 00 00 00 00	 push	 OFFSET ??_C@_1EO@KEMOBAPK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  00045	68 00 02 00 00	 push	 512			; 00000200H
  0004a	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  00050	50		 push	 eax
  00051	e8 00 00 00 00	 call	 _swprintf_s
  00056	83 c4 0c	 add	 esp, 12			; 0000000cH
  00059	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  0005f	50		 push	 eax
  00060	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 177  : 
; 178  : 			newRpcConnection.Initialized = FALSE;

  00066	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0

; 179  : 			newRpcConnection.hRpcBinding = nullptr;

  00070	c7 05 04 01 00
	00 00 00 00 00	 mov	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+260, 0

; 180  : 			newRpcConnection.pAsync = nullptr;

  0007a	c7 05 08 01 00
	00 00 00 00 00	 mov	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+264, 0

; 181  : 			newRpcConnection.hThread = nullptr;

  00084	c7 05 0c 01 00
	00 00 00 00 00	 mov	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+268, 0

; 182  : 
; 183  : 			return RPC_S_OK;

  0008e	33 c0		 xor	 eax, eax
  00090	eb 14		 jmp	 SHORT $LN1@RpcBinding
$LN2@RpcBinding:

; 184  : 		}
; 185  : 	}
; 186  : 
; 187  : 	return CALL_ORIGINAL_FUNC(RpcBindingFree, Binding);

  00092	8b 45 08	 mov	 eax, DWORD PTR _Binding$[ebp]
  00095	50		 push	 eax
  00096	b9 10 00 00 00	 mov	 ecx, 16			; 00000010H
  0009b	c1 e1 02	 shl	 ecx, 2
  0009e	8b 91 0c 00 00
	00		 mov	 edx, DWORD PTR ?APIHooks@@3PAU_APIHook@@A[ecx+12]
  000a4	ff d2		 call	 edx
$LN1@RpcBinding:

; 188  : }

  000a6	5f		 pop	 edi
  000a7	5e		 pop	 esi
  000a8	5b		 pop	 ebx
  000a9	8b e5		 mov	 esp, ebp
  000ab	5d		 pop	 ebp
  000ac	c2 04 00	 ret	 4
?RpcBindingFree_Hook@@YGJPAPAX@Z ENDP			; RpcBindingFree_Hook
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?RpcStringFreeW_Hook@@YGJPAPA_W@Z
_TEXT	SEGMENT
_c$1 = -1024						; size = 1024
_String$ = 8						; size = 4
?RpcStringFreeW_Hook@@YGJPAPA_W@Z PROC			; RpcStringFreeW_Hook, COMDAT

; 153  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c0 04 00
	00		 sub	 esp, 1216		; 000004c0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00011	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 154  : 	if (newRpcConnection.Initialized && String != nullptr)

  00016	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0
  0001d	74 73		 je	 SHORT $LN2@RpcStringF
  0001f	83 7d 08 00	 cmp	 DWORD PTR _String$[ebp], 0
  00023	74 6d		 je	 SHORT $LN2@RpcStringF

; 155  : 	{
; 156  : 		if (newRpcConnection.hThread == GetCurrentThread() && !_wcsicmp(*String, newRpcConnection.pszStringBinding))

  00025	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetCurrentThread@0
  0002b	39 05 0c 01 00
	00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+268, eax
  00031	75 5f		 jne	 SHORT $LN2@RpcStringF
  00033	68 04 00 00 00	 push	 OFFSET ?newRpcConnection@@3U_RpcConnection@@A+4
  00038	8b 45 08	 mov	 eax, DWORD PTR _String$[ebp]
  0003b	8b 08		 mov	 ecx, DWORD PTR [eax]
  0003d	51		 push	 ecx
  0003e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp___wcsicmp
  00044	83 c4 08	 add	 esp, 8
  00047	85 c0		 test	 eax, eax
  00049	75 47		 jne	 SHORT $LN2@RpcStringF

; 157  : 		{
; 158  : 			OutputDebugStringEx(L"[SppExtComObjHook] Free StringBinding...\n");

  0004b	68 00 00 00 00	 push	 OFFSET ??_C@_1FE@FENPFILD@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  00050	68 00 02 00 00	 push	 512			; 00000200H
  00055	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  0005b	50		 push	 eax
  0005c	e8 00 00 00 00	 call	 _swprintf_s
  00061	83 c4 0c	 add	 esp, 12			; 0000000cH
  00064	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  0006a	50		 push	 eax
  0006b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 159  : 
; 160  : 			memset(newRpcConnection.pszStringBinding, 0, sizeof(newRpcConnection.pszStringBinding));

  00071	68 00 01 00 00	 push	 256			; 00000100H
  00076	6a 00		 push	 0
  00078	68 04 00 00 00	 push	 OFFSET ?newRpcConnection@@3U_RpcConnection@@A+4
  0007d	e8 00 00 00 00	 call	 _memset
  00082	83 c4 0c	 add	 esp, 12			; 0000000cH

; 161  : 			*String = nullptr;

  00085	8b 45 08	 mov	 eax, DWORD PTR _String$[ebp]
  00088	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], 0

; 162  : 
; 163  : 			return RPC_S_OK;

  0008e	33 c0		 xor	 eax, eax
  00090	eb 14		 jmp	 SHORT $LN1@RpcStringF
$LN2@RpcStringF:

; 164  : 		}
; 165  : 	}
; 166  : 
; 167  : 	return CALL_ORIGINAL_FUNC(RpcStringFreeW, String);

  00092	8b 45 08	 mov	 eax, DWORD PTR _String$[ebp]
  00095	50		 push	 eax
  00096	b9 10 00 00 00	 mov	 ecx, 16			; 00000010H
  0009b	6b d1 03	 imul	 edx, ecx, 3
  0009e	8b 82 0c 00 00
	00		 mov	 eax, DWORD PTR ?APIHooks@@3PAU_APIHook@@A[edx+12]
  000a4	ff d0		 call	 eax
$LN1@RpcStringF:

; 168  : }

  000a6	5f		 pop	 edi
  000a7	5e		 pop	 esi
  000a8	5b		 pop	 ebx
  000a9	8b e5		 mov	 esp, ebp
  000ab	5d		 pop	 ebp
  000ac	c2 04 00	 ret	 4
?RpcStringFreeW_Hook@@YGJPAPA_W@Z ENDP			; RpcStringFreeW_Hook
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?RpcBindingFromStringBindingW_Hook@@YGJPA_WPAPAX@Z
_TEXT	SEGMENT
_c$1 = -3076						; size = 1024
_ret$ = -2052						; size = 4
_c$2 = -2048						; size = 1024
_c$3 = -1024						; size = 1024
_StringBinding$ = 8					; size = 4
_Binding$ = 12						; size = 4
?RpcBindingFromStringBindingW_Hook@@YGJPA_WPAPAX@Z PROC	; RpcBindingFromStringBindingW_Hook, COMDAT

; 126  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c4 0d 00
	00		 sub	 esp, 3524		; 00000dc4H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00011	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 127  : 	if (StringBinding != nullptr && Binding != nullptr)

  00016	83 7d 08 00	 cmp	 DWORD PTR _StringBinding$[ebp], 0
  0001a	0f 84 c1 00 00
	00		 je	 $LN2@RpcBinding
  00020	83 7d 0c 00	 cmp	 DWORD PTR _Binding$[ebp], 0
  00024	0f 84 b7 00 00
	00		 je	 $LN2@RpcBinding

; 128  : 	{
; 129  : 		if (newRpcConnection.Initialized && newRpcConnection.pAsync == nullptr)

  0002a	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0
  00031	0f 84 aa 00 00
	00		 je	 $LN2@RpcBinding
  00037	83 3d 08 01 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+264, 0
  0003e	0f 85 9d 00 00
	00		 jne	 $LN2@RpcBinding

; 130  : 		{
; 131  : 			if (newRpcConnection.hThread == GetCurrentThread() && !_wcsicmp(StringBinding, newRpcConnection.pszStringBinding))

  00044	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetCurrentThread@0
  0004a	39 05 0c 01 00
	00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+268, eax
  00050	0f 85 8b 00 00
	00		 jne	 $LN2@RpcBinding
  00056	68 04 00 00 00	 push	 OFFSET ?newRpcConnection@@3U_RpcConnection@@A+4
  0005b	8b 45 08	 mov	 eax, DWORD PTR _StringBinding$[ebp]
  0005e	50		 push	 eax
  0005f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp___wcsicmp
  00065	83 c4 08	 add	 esp, 8
  00068	85 c0		 test	 eax, eax
  0006a	75 75		 jne	 SHORT $LN2@RpcBinding

; 132  : 			{
; 133  : 				OutputDebugStringEx(L"[SppExtComObjHook] Emulating Server... Return fake binding...\n");

  0006c	68 00 00 00 00	 push	 OFFSET ??_C@_1HO@OCCPDHFI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  00071	68 00 02 00 00	 push	 512			; 00000200H
  00076	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$3[ebp]
  0007c	50		 push	 eax
  0007d	e8 00 00 00 00	 call	 _swprintf_s
  00082	83 c4 0c	 add	 esp, 12			; 0000000cH
  00085	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$3[ebp]
  0008b	50		 push	 eax
  0008c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 134  : 
; 135  : 				GetRandomBytes((BYTE *)&newRpcConnection.hRpcBinding, sizeof(newRpcConnection.hRpcBinding));

  00092	6a 04		 push	 4
  00094	68 04 01 00 00	 push	 OFFSET ?newRpcConnection@@3U_RpcConnection@@A+260
  00099	e8 00 00 00 00	 call	 ?GetRandomBytes@@YGHPAEK@Z ; GetRandomBytes

; 136  : 				*Binding = newRpcConnection.hRpcBinding;

  0009e	8b 45 0c	 mov	 eax, DWORD PTR _Binding$[ebp]
  000a1	8b 0d 04 01 00
	00		 mov	 ecx, DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+260
  000a7	89 08		 mov	 DWORD PTR [eax], ecx

; 137  : 
; 138  : 				OutputDebugStringEx(L"[SppExtComObjHook] RpcBindingFromStringBindingW called [StringBinding: %s, Binding: 0x%p @ 0x%p].\n", StringBinding, *Binding, Binding);

  000a9	8b 45 0c	 mov	 eax, DWORD PTR _Binding$[ebp]
  000ac	50		 push	 eax
  000ad	8b 4d 0c	 mov	 ecx, DWORD PTR _Binding$[ebp]
  000b0	8b 11		 mov	 edx, DWORD PTR [ecx]
  000b2	52		 push	 edx
  000b3	8b 45 08	 mov	 eax, DWORD PTR _StringBinding$[ebp]
  000b6	50		 push	 eax
  000b7	68 00 00 00 00	 push	 OFFSET ??_C@_1MG@BBLFGBJD@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  000bc	68 00 02 00 00	 push	 512			; 00000200H
  000c1	8d 8d 00 f8 ff
	ff		 lea	 ecx, DWORD PTR _c$2[ebp]
  000c7	51		 push	 ecx
  000c8	e8 00 00 00 00	 call	 _swprintf_s
  000cd	83 c4 18	 add	 esp, 24			; 00000018H
  000d0	8d 85 00 f8 ff
	ff		 lea	 eax, DWORD PTR _c$2[ebp]
  000d6	50		 push	 eax
  000d7	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 139  : 
; 140  : 				return RPC_S_OK;

  000dd	33 c0		 xor	 eax, eax
  000df	eb 57		 jmp	 SHORT $LN1@RpcBinding
$LN2@RpcBinding:

; 141  : 			}
; 142  : 		}
; 143  : 	}
; 144  : 
; 145  : 	RPC_STATUS ret = CALL_ORIGINAL_FUNC(RpcBindingFromStringBindingW, StringBinding, Binding);

  000e1	8b 45 0c	 mov	 eax, DWORD PTR _Binding$[ebp]
  000e4	50		 push	 eax
  000e5	8b 4d 08	 mov	 ecx, DWORD PTR _StringBinding$[ebp]
  000e8	51		 push	 ecx
  000e9	ba 10 00 00 00	 mov	 edx, 16			; 00000010H
  000ee	d1 e2		 shl	 edx, 1
  000f0	8b 82 0c 00 00
	00		 mov	 eax, DWORD PTR ?APIHooks@@3PAU_APIHook@@A[edx+12]
  000f6	ff d0		 call	 eax
  000f8	89 85 fc f7 ff
	ff		 mov	 DWORD PTR _ret$[ebp], eax

; 146  : 
; 147  : 	OutputDebugStringEx(L"[SppExtComObjHook] RpcBindingFromStringBindingW called [StringBinding: %s, Binding: 0x%p @ 0x%p].\n", StringBinding, *Binding, Binding);

  000fe	8b 45 0c	 mov	 eax, DWORD PTR _Binding$[ebp]
  00101	50		 push	 eax
  00102	8b 4d 0c	 mov	 ecx, DWORD PTR _Binding$[ebp]
  00105	8b 11		 mov	 edx, DWORD PTR [ecx]
  00107	52		 push	 edx
  00108	8b 45 08	 mov	 eax, DWORD PTR _StringBinding$[ebp]
  0010b	50		 push	 eax
  0010c	68 00 00 00 00	 push	 OFFSET ??_C@_1MG@BBLFGBJD@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  00111	68 00 02 00 00	 push	 512			; 00000200H
  00116	8d 8d fc f3 ff
	ff		 lea	 ecx, DWORD PTR _c$1[ebp]
  0011c	51		 push	 ecx
  0011d	e8 00 00 00 00	 call	 _swprintf_s
  00122	83 c4 18	 add	 esp, 24			; 00000018H
  00125	8d 85 fc f3 ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  0012b	50		 push	 eax
  0012c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 148  : 
; 149  : 	return ret;

  00132	8b 85 fc f7 ff
	ff		 mov	 eax, DWORD PTR _ret$[ebp]
$LN1@RpcBinding:

; 150  : }

  00138	5f		 pop	 edi
  00139	5e		 pop	 esi
  0013a	5b		 pop	 ebx
  0013b	8b e5		 mov	 esp, ebp
  0013d	5d		 pop	 ebp
  0013e	c2 08 00	 ret	 8
?RpcBindingFromStringBindingW_Hook@@YGJPA_WPAPAX@Z ENDP	; RpcBindingFromStringBindingW_Hook
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?RpcStringBindingComposeW_Hook@@YGJPA_W0000PAPA_W@Z
_TEXT	SEGMENT
_c$1 = -3072						; size = 1024
_c$2 = -2048						; size = 1024
_c$3 = -1024						; size = 1024
_ObjUuid$ = 8						; size = 4
_ProtSeq$ = 12						; size = 4
_NetworkAddr$ = 16					; size = 4
_EndPoint$ = 20						; size = 4
_Options$ = 24						; size = 4
_StringBinding$ = 28					; size = 4
?RpcStringBindingComposeW_Hook@@YGJPA_W0000PAPA_W@Z PROC ; RpcStringBindingComposeW_Hook, COMDAT

; 88   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c0 0d 00
	00		 sub	 esp, 3520		; 00000dc0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00011	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 89   : 	OutputDebugStringEx(L"[SppExtComObjHook] RpcStringBindingComposeW called [ProtSeq: %s, NetWorkAddr: %s, EndPoint: %s].\n", ProtSeq, NetworkAddr, EndPoint);

  00016	8b 45 14	 mov	 eax, DWORD PTR _EndPoint$[ebp]
  00019	50		 push	 eax
  0001a	8b 4d 10	 mov	 ecx, DWORD PTR _NetworkAddr$[ebp]
  0001d	51		 push	 ecx
  0001e	8b 55 0c	 mov	 edx, DWORD PTR _ProtSeq$[ebp]
  00021	52		 push	 edx
  00022	68 00 00 00 00	 push	 OFFSET ??_C@_1ME@JMHPJKGI@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  00027	68 00 02 00 00	 push	 512			; 00000200H
  0002c	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$3[ebp]
  00032	50		 push	 eax
  00033	e8 00 00 00 00	 call	 _swprintf_s
  00038	83 c4 18	 add	 esp, 24			; 00000018H
  0003b	8d 85 00 fc ff
	ff		 lea	 eax, DWORD PTR _c$3[ebp]
  00041	50		 push	 eax
  00042	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 90   : 
; 91   : 	// Check destination address and hook
; 92   : 	if (ProtSeq != nullptr && _wcsicmp(ProtSeq, PROTO_SEQ_TCP) == 0)

  00048	83 7d 0c 00	 cmp	 DWORD PTR _ProtSeq$[ebp], 0
  0004c	0f 84 e2 00 00
	00		 je	 $LN2@RpcStringB
  00052	68 00 00 00 00	 push	 OFFSET ??_C@_1BK@BPGFLIHL@?$AAn?$AAc?$AAa?$AAc?$AAn?$AA_?$AAi?$AAp?$AA_?$AAt?$AAc?$AAp@
  00057	8b 45 0c	 mov	 eax, DWORD PTR _ProtSeq$[ebp]
  0005a	50		 push	 eax
  0005b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp___wcsicmp
  00061	83 c4 08	 add	 esp, 8
  00064	85 c0		 test	 eax, eax
  00066	0f 85 c8 00 00
	00		 jne	 $LN2@RpcStringB

; 93   : 	{
; 94   : 		ReadRegistrySettings();

  0006c	e8 00 00 00 00	 call	 ?ReadRegistrySettings@@YGKXZ ; ReadRegistrySettings

; 95   : 
; 96   : 		if (!newRpcConnection.Initialized)

  00071	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0
  00078	0f 85 b6 00 00
	00		 jne	 $LN2@RpcStringB

; 97   : 		{
; 98   : 			if (Settings.KMSEnabled)

  0007e	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?Settings@@3UKMSServerSettings@@A, 0
  00085	74 6d		 je	 SHORT $LN4@RpcStringB

; 99   : 			{
; 100  : 				OutputDebugStringEx(L"[SppExtComObjHook] Connection Detected... Emulating Server...\n");

  00087	68 00 00 00 00	 push	 OFFSET ??_C@_1HO@DNFNIJBK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  0008c	68 00 02 00 00	 push	 512			; 00000200H
  00091	8d 85 00 f8 ff
	ff		 lea	 eax, DWORD PTR _c$2[ebp]
  00097	50		 push	 eax
  00098	e8 00 00 00 00	 call	 _swprintf_s
  0009d	83 c4 0c	 add	 esp, 12			; 0000000cH
  000a0	8d 85 00 f8 ff
	ff		 lea	 eax, DWORD PTR _c$2[ebp]
  000a6	50		 push	 eax
  000a7	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 101  : 
; 102  : 				newRpcConnection.Initialized = TRUE;

  000ad	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 1

; 103  : 				newRpcConnection.hThread = GetCurrentThread();

  000b7	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetCurrentThread@0
  000bd	a3 0c 01 00 00	 mov	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A+268, eax

; 104  : 				swprintf_s(newRpcConnection.pszStringBinding, _countof(newRpcConnection.pszStringBinding), L"%s:%s[%s]", ProtSeq, NetworkAddr, EndPoint);

  000c2	8b 45 14	 mov	 eax, DWORD PTR _EndPoint$[ebp]
  000c5	50		 push	 eax
  000c6	8b 4d 10	 mov	 ecx, DWORD PTR _NetworkAddr$[ebp]
  000c9	51		 push	 ecx
  000ca	8b 55 0c	 mov	 edx, DWORD PTR _ProtSeq$[ebp]
  000cd	52		 push	 edx
  000ce	68 00 00 00 00	 push	 OFFSET ??_C@_1BE@LJLJKOKP@?$AA?$CF?$AAs?$AA?3?$AA?$CF?$AAs?$AA?$FL?$AA?$CF?$AAs?$AA?$FN@
  000d3	68 80 00 00 00	 push	 128			; 00000080H
  000d8	68 04 00 00 00	 push	 OFFSET ?newRpcConnection@@3U_RpcConnection@@A+4
  000dd	e8 00 00 00 00	 call	 _swprintf_s
  000e2	83 c4 18	 add	 esp, 24			; 00000018H

; 105  : 				*StringBinding = newRpcConnection.pszStringBinding;

  000e5	8b 45 1c	 mov	 eax, DWORD PTR _StringBinding$[ebp]
  000e8	c7 00 04 00 00
	00		 mov	 DWORD PTR [eax], OFFSET ?newRpcConnection@@3U_RpcConnection@@A+4

; 106  : 
; 107  : 				return RPC_S_OK;

  000ee	33 c0		 xor	 eax, eax
  000f0	eb 6a		 jmp	 SHORT $LN1@RpcStringB

; 108  : 			}

  000f2	eb 40		 jmp	 SHORT $LN2@RpcStringB
$LN4@RpcStringB:

; 109  : 			else
; 110  : 			{
; 111  : 				// Redirect rpcrt4 call to localhost
; 112  : 				OutputDebugStringEx(L"[SppExtComObjHook] Replaced NetworkAddr from %s to %s\n", NetworkAddr, LOCALHOST_IP);

  000f4	68 00 00 00 00	 push	 OFFSET ??_C@_1BE@KGBJBGOH@?$AA1?$AA2?$AA7?$AA?4?$AA0?$AA?4?$AA0?$AA?4?$AA1@
  000f9	8b 45 10	 mov	 eax, DWORD PTR _NetworkAddr$[ebp]
  000fc	50		 push	 eax
  000fd	68 00 00 00 00	 push	 OFFSET ??_C@_1GO@DBPOPFCA@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  00102	68 00 02 00 00	 push	 512			; 00000200H
  00107	8d 8d 00 f4 ff
	ff		 lea	 ecx, DWORD PTR _c$1[ebp]
  0010d	51		 push	 ecx
  0010e	e8 00 00 00 00	 call	 _swprintf_s
  00113	83 c4 14	 add	 esp, 20			; 00000014H
  00116	8d 85 00 f4 ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  0011c	50		 push	 eax
  0011d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 113  : 
; 114  : 				newRpcConnection.Initialized = FALSE;

  00123	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?newRpcConnection@@3U_RpcConnection@@A, 0

; 115  : 
; 116  : 				NetworkAddr = const_cast<wchar_t*>(LOCALHOST_IP);

  0012d	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _NetworkAddr$[ebp], OFFSET ??_C@_1BE@KGBJBGOH@?$AA1?$AA2?$AA7?$AA?4?$AA0?$AA?4?$AA0?$AA?4?$AA1@
$LN2@RpcStringB:

; 117  : 			}
; 118  : 		}
; 119  : 	}
; 120  : 
; 121  : 	// Call original function
; 122  : 	return CALL_ORIGINAL_FUNC(RpcStringBindingComposeW, ObjUuid, ProtSeq, NetworkAddr, EndPoint, Options, StringBinding);

  00134	8b 45 1c	 mov	 eax, DWORD PTR _StringBinding$[ebp]
  00137	50		 push	 eax
  00138	8b 4d 18	 mov	 ecx, DWORD PTR _Options$[ebp]
  0013b	51		 push	 ecx
  0013c	8b 55 14	 mov	 edx, DWORD PTR _EndPoint$[ebp]
  0013f	52		 push	 edx
  00140	8b 45 10	 mov	 eax, DWORD PTR _NetworkAddr$[ebp]
  00143	50		 push	 eax
  00144	8b 4d 0c	 mov	 ecx, DWORD PTR _ProtSeq$[ebp]
  00147	51		 push	 ecx
  00148	8b 55 08	 mov	 edx, DWORD PTR _ObjUuid$[ebp]
  0014b	52		 push	 edx
  0014c	b8 10 00 00 00	 mov	 eax, 16			; 00000010H
  00151	c1 e0 00	 shl	 eax, 0
  00154	8b 88 0c 00 00
	00		 mov	 ecx, DWORD PTR ?APIHooks@@3PAU_APIHook@@A[eax+12]
  0015a	ff d1		 call	 ecx
$LN1@RpcStringB:

; 123  : }

  0015c	5f		 pop	 edi
  0015d	5e		 pop	 esi
  0015e	5b		 pop	 ebx
  0015f	8b e5		 mov	 esp, ebp
  00161	5d		 pop	 ebp
  00162	c2 18 00	 ret	 24			; 00000018H
?RpcStringBindingComposeW_Hook@@YGJPA_W0000PAPA_W@Z ENDP ; RpcStringBindingComposeW_Hook
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
; File C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\ucrt\corecrt_wstring.h
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
; File C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\ucrt\corecrt_wstring.h
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp
;	COMDAT ?LoadLibraryW_Hook@@YGPAUHINSTANCE__@@PB_W@Z
_TEXT	SEGMENT
_c$1 = -2572						; size = 1024
_lpUpCaseFileName$ = -1548				; size = 520
_c$2 = -1028						; size = 1024
_hModule$ = -4						; size = 4
_lpFileName$ = 8					; size = 4
?LoadLibraryW_Hook@@YGPAUHINSTANCE__@@PB_W@Z PROC	; LoadLibraryW_Hook, COMDAT

; 61   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 8c 0b 00
	00		 sub	 esp, 2956		; 00000b8cH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	b9 00 00 00 00	 mov	 ecx, OFFSET __4CDD1C48_SppExtComObjHook@cpp
  00011	e8 00 00 00 00	 call	 @__CheckForDebuggerJustMyCode@4

; 62   : 	HMODULE hModule = CALL_ORIGINAL_FUNC(LoadLibraryW, lpFileName);

  00016	8b 45 08	 mov	 eax, DWORD PTR _lpFileName$[ebp]
  00019	50		 push	 eax
  0001a	b9 10 00 00 00	 mov	 ecx, 16			; 00000010H
  0001f	6b d1 00	 imul	 edx, ecx, 0
  00022	8b 82 0c 00 00
	00		 mov	 eax, DWORD PTR ?APIHooks@@3PAU_APIHook@@A[edx+12]
  00028	ff d0		 call	 eax
  0002a	89 45 fc	 mov	 DWORD PTR _hModule$[ebp], eax

; 63   : 
; 64   : 	if (hModule == nullptr)

  0002d	83 7d fc 00	 cmp	 DWORD PTR _hModule$[ebp], 0
  00031	75 14		 jne	 SHORT $LN2@LoadLibrar

; 65   : 	{
; 66   : 		SetLastError(GetLastError());

  00033	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetLastError@0
  00039	50		 push	 eax
  0003a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetLastError@4

; 67   : 		return nullptr;

  00040	33 c0		 xor	 eax, eax
  00042	e9 c3 00 00 00	 jmp	 $LN1@LoadLibrar
$LN2@LoadLibrar:

; 68   : 	}
; 69   : 
; 70   : 	OutputDebugStringEx(L"[SppExtComObjHook] LoadLibraryW called. [lpFileName: %s, base: 0x%p]\n", lpFileName, hModule);

  00047	8b 45 fc	 mov	 eax, DWORD PTR _hModule$[ebp]
  0004a	50		 push	 eax
  0004b	8b 4d 08	 mov	 ecx, DWORD PTR _lpFileName$[ebp]
  0004e	51		 push	 ecx
  0004f	68 00 00 00 00	 push	 OFFSET ??_C@_1IM@KEMAINMH@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  00054	68 00 02 00 00	 push	 512			; 00000200H
  00059	8d 95 fc fb ff
	ff		 lea	 edx, DWORD PTR _c$2[ebp]
  0005f	52		 push	 edx
  00060	e8 00 00 00 00	 call	 _swprintf_s
  00065	83 c4 14	 add	 esp, 20			; 00000014H
  00068	8d 85 fc fb ff
	ff		 lea	 eax, DWORD PTR _c$2[ebp]
  0006e	50		 push	 eax
  0006f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 71   : 
; 72   : 	WCHAR lpUpCaseFileName[_MAX_PATH];
; 73   : 	wcscpy_s(lpUpCaseFileName, _countof(lpUpCaseFileName), lpFileName);

  00075	8b 45 08	 mov	 eax, DWORD PTR _lpFileName$[ebp]
  00078	50		 push	 eax
  00079	68 04 01 00 00	 push	 260			; 00000104H
  0007e	8d 8d f4 f9 ff
	ff		 lea	 ecx, DWORD PTR _lpUpCaseFileName$[ebp]
  00084	51		 push	 ecx
  00085	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__wcscpy_s
  0008b	83 c4 0c	 add	 esp, 12			; 0000000cH

; 74   : 	_wcsupr_s(lpUpCaseFileName, _countof(lpUpCaseFileName));

  0008e	68 04 01 00 00	 push	 260			; 00000104H
  00093	8d 85 f4 f9 ff
	ff		 lea	 eax, DWORD PTR _lpUpCaseFileName$[ebp]
  00099	50		 push	 eax
  0009a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp___wcsupr_s
  000a0	83 c4 08	 add	 esp, 8
; File C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\ucrt\corecrt_wstring.h

; 560  :         return const_cast<wchar_t*>(wcsstr(static_cast<wchar_t const*>(_String), _SubStr));

  000a3	68 00 00 00 00	 push	 OFFSET ??_C@_1BK@MGFBEOIA@?$AAO?$AAS?$AAP?$AAP?$AAO?$AAB?$AAJ?$AAS?$AA?4?$AAD?$AAL?$AAL@
  000a8	8d 85 f4 f9 ff
	ff		 lea	 eax, DWORD PTR _lpUpCaseFileName$[ebp]
  000ae	50		 push	 eax
  000af	e8 00 00 00 00	 call	 _wcsstr
  000b4	83 c4 08	 add	 esp, 8
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp

; 76   : 	if ( !wcsstr(lpUpCaseFileName, L"OSPPOBJS.DLL") && !wcsstr(lpUpCaseFileName, L"SPPOBJS.DLL") )

  000b7	85 c0		 test	 eax, eax
  000b9	75 43		 jne	 SHORT $LN3@LoadLibrar
; File C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\ucrt\corecrt_wstring.h

; 560  :         return const_cast<wchar_t*>(wcsstr(static_cast<wchar_t const*>(_String), _SubStr));

  000bb	68 00 00 00 00	 push	 OFFSET ??_C@_1BI@IDEMALCL@?$AAS?$AAP?$AAP?$AAO?$AAB?$AAJ?$AAS?$AA?4?$AAD?$AAL?$AAL@
  000c0	8d 85 f4 f9 ff
	ff		 lea	 eax, DWORD PTR _lpUpCaseFileName$[ebp]
  000c6	50		 push	 eax
  000c7	e8 00 00 00 00	 call	 _wcsstr
  000cc	83 c4 08	 add	 esp, 8
; File C:\Users\Administrator\Documents\SppExtComObjHook-DLL-20181024\SppExtComObjHook\SppExtComObjHook.cpp

; 76   : 	if ( !wcsstr(lpUpCaseFileName, L"OSPPOBJS.DLL") && !wcsstr(lpUpCaseFileName, L"SPPOBJS.DLL") )

  000cf	85 c0		 test	 eax, eax
  000d1	75 2b		 jne	 SHORT $LN3@LoadLibrar

; 77   : 	{
; 78   : 		OutputDebugStringEx(L"[SppExtComObjHook] Not a target module. Skipped patching...\n");

  000d3	68 00 00 00 00	 push	 OFFSET ??_C@_1HK@KJBODIAK@?$AA?$FL?$AAS?$AAp?$AAp?$AAE?$AAx?$AAt?$AAC?$AAo?$AAm?$AAO?$AAb?$AAj?$AAH?$AAo@
  000d8	68 00 02 00 00	 push	 512			; 00000200H
  000dd	8d 85 f4 f5 ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  000e3	50		 push	 eax
  000e4	e8 00 00 00 00	 call	 _swprintf_s
  000e9	83 c4 0c	 add	 esp, 12			; 0000000cH
  000ec	8d 85 f4 f5 ff
	ff		 lea	 eax, DWORD PTR _c$1[ebp]
  000f2	50		 push	 eax
  000f3	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__OutputDebugStringW@4

; 79   : 		return hModule;

  000f9	8b 45 fc	 mov	 eax, DWORD PTR _hModule$[ebp]
  000fc	eb 0c		 jmp	 SHORT $LN1@LoadLibrar
$LN3@LoadLibrar:

; 80   : 	}
; 81   : 
; 82   : 	PatchIAT(hModule);

  000fe	8b 45 fc	 mov	 eax, DWORD PTR _hModule$[ebp]
  00101	50		 push	 eax
  00102	e8 00 00 00 00	 call	 ?PatchIAT@@YGHPAUHINSTANCE__@@@Z ; PatchIAT

; 83   : 
; 84   : 	return hModule;

  00107	8b 45 fc	 mov	 eax, DWORD PTR _hModule$[ebp]
$LN1@LoadLibrar:

; 85   : }

  0010a	5f		 pop	 edi
  0010b	5e		 pop	 esi
  0010c	5b		 pop	 ebx
  0010d	8b e5		 mov	 esp, ebp
  0010f	5d		 pop	 ebp
  00110	c2 04 00	 ret	 4
?LoadLibraryW_Hook@@YGPAUHINSTANCE__@@PB_W@Z ENDP	; LoadLibraryW_Hook
_TEXT	ENDS
END
